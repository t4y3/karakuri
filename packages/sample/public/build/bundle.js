var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function i(t){t.forEach(e)}function o(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(e,...n){if(null==e)return t;const i=e.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}function s(t,e){t.appendChild(e)}function l(t,e,n){t.insertBefore(e,n||null)}function h(t){t.parentNode.removeChild(t)}function u(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function p(){return d(" ")}function c(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}let f;function v(t){f=t}function m(){if(!f)throw new Error("Function called outside component initialization");return f}function g(t){m().$$.on_mount.push(t)}function b(t){m().$$.on_destroy.push(t)}const _=[],x=[],y=[],w=[],E=Promise.resolve();let C=!1;function k(t){y.push(t)}const L=new Set;let V=0;function M(){const t=f;do{for(;V<_.length;){const t=_[V];V++,v(t),A(t.$$)}for(v(null),_.length=0,V=0;x.length;)x.pop()();for(let t=0;t<y.length;t+=1){const e=y[t];L.has(e)||(L.add(e),e())}y.length=0}while(_.length);for(;w.length;)w.pop()();C=!1,L.clear(),v(t)}function A(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(k)}}const P=new Set;let I;function S(){I={r:0,c:[],p:I}}function F(){I.r||i(I.c),I=I.p}function R(t,e){t&&t.i&&(P.delete(t),t.i(e))}function B(t,e,n,i){if(t&&t.o){if(P.has(t))return;P.add(t),I.c.push((()=>{P.delete(t),i&&(n&&t.d(1),i())})),t.o(e)}}function O(t){t&&t.c()}function T(t,n,r,a){const{fragment:s,on_mount:l,on_destroy:h,after_update:u}=t.$$;s&&s.m(n,r),a||k((()=>{const n=l.map(e).filter(o);h?h.push(...n):i(n),t.$$.on_mount=[]})),u.forEach(k)}function D(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function N(t,e){-1===t.$$.dirty[0]&&(_.push(t),C||(C=!0,E.then(M)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function $(e,o,r,a,s,l,u,d=[-1]){const p=f;v(e);const c=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(p?p.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:o.target||p.$$.root};u&&u(c.root);let m=!1;if(c.ctx=r?r(e,o.props||{},((t,n,...i)=>{const o=i.length?i[0]:n;return c.ctx&&s(c.ctx[t],c.ctx[t]=o)&&(!c.skip_bound&&c.bound[t]&&c.bound[t](o),m&&N(e,t)),n})):[],c.update(),m=!0,i(c.before_update),c.fragment=!!a&&a(c.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);c.fragment&&c.fragment.l(t),t.forEach(h)}else c.fragment&&c.fragment.c();o.intro&&R(e.$$.fragment),T(e,o.target,o.anchor,o.customElement),M()}v(p)}class z{$destroy(){D(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var j=class extends HTMLElement{constructor(t,e,n=!0){super(),this.editing=!1,this.attachShadow({mode:"open"}),this.axes=t,this.totalTime=e,this.debug=n,this.shadowRoot.innerHTML=this.template(t,e),this.$pane=this.shadowRoot.querySelector("#pane"),this.$timeline=this.shadowRoot.querySelector("#timeline"),this.$current=this.shadowRoot.querySelector("#current"),this.$progress=this.shadowRoot.querySelector("#progress"),this.$labels=this.shadowRoot.querySelectorAll(".label"),this.$bars=this.shadowRoot.querySelectorAll(".bar"),this.$barsBegin=this.shadowRoot.querySelectorAll(".begin"),this.$barsEnd=this.shadowRoot.querySelectorAll(".end"),this.$previous=this.shadowRoot.querySelector("#previous"),this.$playPause=this.shadowRoot.querySelector("#play-pause"),this.$next=this.shadowRoot.querySelector("#next"),this.playing=!0,this.previous=!1,this.next=!1,this.skip=-1,this.$previous.addEventListener("click",(t=>{this.previous=!0})),this.$playPause.addEventListener("click",(t=>{this.playing=!this.playing})),this.$next.addEventListener("click",(t=>{this.next=!0}));for(let t=0,e=this.$bars.length;t<e;t++){if(this.$bars[t].addEventListener("click",(t=>{let e=t.currentTarget,n=Number(e.getAttribute("idx"));this.skip=n})),!this.debug)continue;let e=this.$barsBegin[t],n=this.$barsEnd[t];e.addEventListener("input",(n=>{let i=Number(e.value);if(Number(this.$barsEnd[t].value)<i)n.preventDefault();else if(Number.isFinite(this.axes[t].position))this.axes[t].position=i,this.axes[t].duration=this.axes[t].endAt-(this.axes[t].delay+this.axes[t].position);else{let e=this.axes.find((e=>e.key===this.axes[t].position));this.axes[t].delay=i-e.endAt,this.axes[t].duration=this.axes[t].endAt-(this.axes[t].delay+e.endAt)}})),n.addEventListener("input",(e=>{let i=Number(n.value);if(i<Number(this.$barsBegin[t].value))e.preventDefault();else if(Number.isFinite(this.axes[t].position))this.axes[t].duration=i-(this.axes[t].position+this.axes[t].delay);else{let e=this.axes.find((e=>e.key===this.axes[t].position));this.axes[t].duration=i-e.endAt-this.axes[t].delay}}))}this.$labels.forEach((t=>{t.addEventListener("click",(t=>{let e=t.currentTarget,n=Number(e.getAttribute("idx"));this.skip=n}))})),this.$current.addEventListener("input",(t=>{this.editing=!0;let e=Number(this.$current.value);this.__updateProgressPosition(e),this.__updateBar(this.totalTime)})),this.$current.addEventListener("change",(t=>{this.editing=!1}))}attributeChangedCallback(){}connectedCallback(){}disconnectedCallback(){}getAxes(){return this.axes}get(t){let e=Date.now(),n=Number(this.$current.value),i=e-t;if(this.playing||(t=e-n,i=n),this.editing&&(t=e-n,i=n),-1<this.skip){let n=this.axes[this.skip];t=e-n.beginAt,i=n.beginAt,this.skip=-1}return this.previous&&(this.previous=!1,t=e,i=0),this.next&&(this.next=!1,t=e-this.totalTime,i=this.totalTime),{beginAt:t,elapsedTime:i,editing:this.editing}}update(t,e,n){this.axes=n,this.totalTime=e,this.$current.setAttribute("max",e),this.$current.value=t,this.__updateProgressPosition(t),this.__updateBar(e),this.debug&&this.__updateBarRange(e),this.__updateScale(e)}template(t,e){let n="",i="",o="";for(let e=0;e<t.length;e++){let o=t[e];n+=`<div class="row" id="row-${e}"><div class="label" idx="${e}">${o.key}</div></div>`;let r="";this.debug&&(r=`\n          <input class="begin" type="range" min="0" max="0" step="10" value="${o.beginAt}">\n          <input class="end" type="range" min="0" max="0" step="10" value="${o.endAt}">\n        `),i+=`\n        <div class="row">\n          <div class="bar bar--${this.debug?"debug":"default"}" idx="${e}"></div>\n          ${r}\n        </div>`,this.debug}for(let t=0,n=Math.floor(e/1e3);t<n;t++)o+=`<div class="scale-label" style="--sec: ${t+1}">${t+1}s</div>`;return`\n      <style>\n        * {\n          box-sizing: border-box;\n        }\n        :host {\n          display: block;\n          height: 100%;\n        }\n        .container {\n          display: flex;\n          flex-direction: column;\n          height: 100%;\n          background-color: #313131;\n          color: #eeeeee;\n          position: relative;\n          --tools-height: 40px;\n          --controls-height: 40px;\n        }\n        .tools {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          flex-shrink: 0;\n          height: var(--tools-height);\n          border-bottom: 1px solid #202020;\n        }\n        .tools__item {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          width: 20px;\n          margin: 0 8px;\n          color: #eeeeee;\n        }\n        .tools__item div {\n          width: 100%;\n          cursor: pointer;\n        }\n        .tools__item div:hover {\n          opacity: .6;\n        }\n        .tools__item svg {\n          fill: currentColor;\n        }\n        .controls {\n          display: flex;\n          flex-shrink: 0;\n          height: var(--controls-height);\n          border-bottom: 1px solid #202020;\n        }\n        .pane {\n          display: flex;\n          flex: 1;\n          overflow: scroll;\n          scroll-behavior: smooth;\n        }\n        .head {\n          flex-shrink: 0;\n          flex-basis: 20%;\n          max-width: 200px;\n          min-width: 0;\n        }\n        .body {\n          flex: 1;\n          position: relative;\n        }\n        .actions {\n          height: 100%;\n          border-right: 1px solid #222322;\n        }\n        .rows {\n          border-right: 1px solid #222322;\n        }\n        .row {\n          display: flex;\n          align-items: center;\n          height: 24px;\n          border-bottom: 1px solid #202020;\n          position: relative;\n        }\n        .row input[type="range"] {\n          position: absolute;\n          inset: 0;\n        }\n        .label {\n          padding-left: 12px;\n          font-size: 12px;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          cursor: pointer;\n        }\n        .bar {\n          height: 100%;\n          background-color: #545454;\n          opacity: .5;\n          transform-origin: left;\n          cursor: pointer;\n          position: relative;\n        }\n        .bar.bar--debug::before {\n          content: "";\n          display: block;\n          width: 6px;\n          position: absolute;\n          left: 0;\n          top: 0;\n          bottom: 0;\n          margin: 4px;\n          border-radius: 2px;\n          background-color: darkgray;\n        }\n        .bar.bar--debug::after {\n          content: "";\n          display: block;\n          width: 6px;\n          position: absolute;\n          right: 0;\n          top: 0;\n          bottom: 0;\n          margin: 4px;\n          border-radius: 2px;\n          background-color: darkgray;\n        }\n        .bar.bar--active {\n          opacity: 1;\n        }\n        .progress {\n          position: absolute;\n          top: var(--tools-height);\n          bottom: 0;\n          left: 0;\n          width: 2px;\n          margin-left: min(20%, 200px);\n          background-color: #71A0EB;\n          opacity: 0.6;\n        }\n        .progress::before {\n          content: "";\n          display: block;\n          width: 20px;\n          height: 30px;\n          background-color: #53aeff;\n          margin-left: -9px;\n        }\n        .progress::after {\n          content: "";\n          display: block;\n          border-top: 10px solid #53aeff;\n          border-left: 10px solid transparent;\n          border-right: 10px solid transparent;\n          margin-left: -9px;\n        }\n        .current {\n          position: absolute;\n          top: var(--tools-height);\n          height: var(--controls-height);\n          left: -12px;\n          right: -12px;\n          margin-left: min(20%, 200px);\n        }\n        input[type="range"] {\n          -webkit-appearance: none;\n          appearance: none;\n          margin: 0;\n          cursor: pointer;\n          outline: none;\n        }\n        input[type="range"]::-webkit-slider-thumb {\n          opacity: 0;\n        }\n        input[type="range"]::-moz-range-thumb {\n          opacity: 0;\n        }\n        /* Firefoxで点線が周りに表示されてしまう問題の解消 */\n        input[type="range"]::-moz-focus-outer {\n          border: 0;\n        }\n        .current input[type="range"] {\n          height: var(--controls-height);\n          width: 100%;\n          background: transparent;\n        }\n        input.begin[type="range"],\n        input.end[type="range"] {\n          height: 100%;\n          width: calc(100% + 12px);\n          background: transparent;\n          pointer-events: none;\n          margin-left: -6px;\n        }\n        input.begin[type="range"]::-webkit-slider-thumb,\n        input.end[type="range"]::-webkit-slider-thumb {\n          -webkit-appearance: none;\n          appearance: none;\n          pointer-events: auto;\n          opacity: 0;   \n          width: 12px;\n          height: 100%;\n          cursor: ew-resize;\n        }\n        input.begin[type="range"]::-moz-range-thumb,\n        input.end[type="range"]::-moz-range-thumb {\n          -webkit-appearance: none;\n          appearance: none;\n          pointer-events: auto;\n          opacity: 0;   \n          width: 12px;\n          height: 100%;\n          cursor: ew-resize;\n        }\n        input.begin[type="range"]::-webkit-slider-thumb {\n          background: darkgreen;\n          transform: translateX(50%);\n        }\n        input.begin[type="range"]::-moz-range-thumb {\n          background: darkgreen;\n          transform: translateX(50%);\n        }\n        input.end[type="range"]::-webkit-slider-thumb {\n          background: indianred;\n          transform: translateX(-50%);\n        }\n        input.end[type="range"]::-moz-range-thumb {\n          background: indianred;\n          transform: translateX(-50%);\n        }\n        .scale {\n          position: relative;\n          height: 100%;\n        }\n        .scale-s,\n        .scale-100ms {\n          height: 50%;\n        }\n        .scale-s {\n          /*\n            total / 1s \n            e.g. 6000 / 1000\n            x / 1000 = 6\n            calc(100% / calc(var(--total) / 1000))\n           */\n          --x: calc(100% / calc(var(--total) / 1000));\n          background: repeating-linear-gradient(90deg, transparent 0, transparent calc(var(--x) - 1px), #202020 calc(var(--x) - 1px), #202020 var(--x));\n          border-bottom: 1px solid #202020;\n        }\n        .scale-100ms {\n          --x: calc(100% / calc(var(--total) / 1000) / 10);\n          background: repeating-linear-gradient(90deg, transparent 0, transparent calc(var(--x) - 1px), #202020 calc(var(--x) - 1px), #202020 var(--x));\n        }\n        .scale-label {\n          --x: calc(100% / calc(var(--total) / 1000));\n          position: absolute;\n          top: 0;\n          left: calc(var(--x) * var(--sec));\n          font-size: 10px;\n          font-style: italic;\n          transform: translateX(calc(-100% - 4px));\n        }\n      </style>\n      <div class="container">\n        <div class="tools">\n          <div class="tools__item">\n            <div id="previous">\n              <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n                <path d="M2.75 20C2.75 20.5523 3.19772 21 3.75 21C4.30228 21 4.75 20.5523 4.75 20L4.75 4C4.75 3.44772 4.30229 3 3.75 3C3.19772 3 2.75 3.44772 2.75 4V20Z"/>\n                <path d="M20.75 19.0526C20.75 20.4774 19.1383 21.305 17.9803 20.4748L7.51062 12.9682C6.50574 12.2477 6.54467 10.7407 7.5854 10.073L18.0551 3.35665C19.2198 2.60946 20.75 3.44583 20.75 4.82961L20.75 19.0526Z"/>\n              </svg>\n            </div>\n          </div>\n          <div class="tools__item">\n            <div id="play-pause">\n              <svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                \x3c!-- Generator: Sketch 59.1 (86144) - https://sketch.com --\x3e\n                <title>ic_fluent_video_play_pause_24_filled</title>\n                <desc>Created with Sketch.</desc>\n                <g id="🔍-Product-Icons" stroke="none" stroke-width="1" >\n                    <g id="ic_fluent_video_play_pause_24_filled" fill-rule="nonzero">\n                        <path d="M3.65140982,6.61646219 L11.1528787,11.3693959 C11.3672679,11.5052331 11.4827597,11.722675 11.4993749,11.9464385 L11.4984593,7.25 C11.4984593,6.83578644 11.8342458,6.5 12.2484593,6.5 L15.2484593,6.5 C15.6626729,6.5 15.9984593,6.83578644 15.9984593,7.25 L15.9984593,16.75 C15.9984593,17.1642136 15.6626729,17.5 15.2484593,17.5 L12.2484593,17.5 C11.8342458,17.5 11.4984593,17.1642136 11.4984593,16.75 L11.4993494,12.0597632 C11.4826318,12.2835468 11.3670166,12.5009613 11.1525249,12.6366956 L3.65105604,17.3837618 C3.15168144,17.6997752 2.5,17.3409648 2.5,16.75 L2.5,7.25 C2.5,6.65884683 3.15205264,6.30006928 3.65140982,6.61646219 Z M21.2477085,6.50037474 C21.661922,6.50037474 21.9977085,6.83616118 21.9977085,7.25037474 L21.9977085,16.7496253 C21.9977085,17.1638388 21.661922,17.4996253 21.2477085,17.4996253 L18.2477085,17.4996253 C17.8334949,17.4996253 17.4977085,17.1638388 17.4977085,16.7496253 L17.4977085,7.25037474 C17.4977085,6.83616118 17.8334949,6.50037474 18.2477085,6.50037474 L21.2477085,6.50037474 Z" id="🎨-Color"></path>\n                    </g>\n                </g>\n              </svg>\n            </div>\n          </div>\n          <div class="tools__item">\n            <div id="next">\n              <svg   viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n                <path d="M21 4C21 3.44772 20.5523 3 20 3C19.4477 3 19 3.44772 19 4V20C19 20.5523 19.4477 21 20 21C20.5523 21 21 20.5523 21 20V4Z"/>\n                <path d="M3 4.94743C3 3.5226 4.61175 2.69498 5.7697 3.52521L16.2394 11.0318C17.2443 11.7523 17.2053 13.2593 16.1646 13.927L5.69492 20.6434C4.53019 21.3905 3 20.5542 3 19.1704V4.94743Z"/>\n              </svg>\n            </div>\n          </div>\n        </div>\n        <div class="controls">\n          <div class="head"><div class="actions"></div></div>\n          <div class="body">\n            <div class="scale" id="scale" style="--total: ${e}">\n              <div class="scale-s"></div>\n              <div class="scale-100ms"></div>\n              ${o}\n            </div>\n          </div>\n        </div>\n        <div id="pane" class="pane">\n          <div class="head">\n            <div class="rows">\n              ${n}\n            </div>\n          </div>\n          <div id="timeline" class="body">\n            <div class="rows">\n              ${i}\n            </div>\n          </div>\n        </div>\n        <div class="current">\n          <input id="current" type="range" min="0" max="0" step="any" value="0">\n        </div>\n        <div id="progress" class="progress"></div>\n      </div>\n    `}__updateScale(t){let e=this.shadowRoot.querySelector(".test");e&&e.remove(),this.shadowRoot.querySelectorAll(".scale-label").forEach((t=>{t.remove()})),this.shadowRoot.querySelector(".scale").style.setProperty("--total",t);let n="";for(let e=0,i=Math.floor(t/1e3);e<i;e++)n+=`<div class="scale-label" style="--sec: ${e+1}">${e+1}s</div>`;let i=document.createElement("div");i.className="test",i.innerHTML=n,this.shadowRoot.querySelector(".scale").appendChild(i)}__updateProgressPosition(t){let e=this.$timeline.clientWidth,n=Math.min(t/this.totalTime,1)*e;this.$progress.style.transform=`translateX(${n}px)`}__updateBarRange(t){for(let e=0;e<this.$bars.length;e++){let n=this.axes[e];this.$barsBegin[e].setAttribute("max",t),this.$barsBegin[e].value=n.beginAt,this.$barsEnd[e].setAttribute("max",t),this.$barsEnd[e].value=n.endAt}}__updateBar(t){let e=this.$timeline.clientWidth/t;for(let t=0;t<this.$bars.length;t++){let n=this.axes[t],i=n.beginAt*e,o=(n.endAt-n.beginAt)*e;this.$bars[t].style.transform=`translateX(${i}px)`,this.$bars[t].style.width=`${o}px`,0<n.progress&&!n.pass?this.$bars[t].classList.add("bar--active"):this.$bars[t].classList.remove("bar--active")}}};window.customElements.define("taxis-timeline",j);var H={key:"",beginAt:0,endAt:0,duration:0,delay:0,position:0,progress:0,enter:!1,pass:!1},U=class{constructor(t={}){this.option=t,this.axes=[]}get totalTime(){return this.axes.length?Math.max(...this.axes.map((t=>t.endAt))):0}get totalTimeForTimeline(){return this.totalTime+500}get everyPassed(){return this.axes.every((t=>t.pass))}restart(){this.beginAt=Date.now()}getAxis({key:t}){return this.axes.find((e=>e.key===t))}getAxes(){return this.axes}add(t,e,n=0,i){let o=this.totalTime+n;if(void 0!==i)o=Number.isFinite(i)?i+n:this.getAxis({key:i}).endAt+n;else{let t=this.axes[this.axes.length-1];i=t?t.key:0}return this.axes.push({...H,key:t,beginAt:o,endAt:o+e,duration:e,delay:n,position:i}),this.sort(),this}begin(){this.option.timeline&&(this.timeline=new j(this.axes,this.totalTimeForTimeline,this.option.timeline.debug),this.option.timeline.container.appendChild(this.timeline)),this.beginAt=Date.now(),this.__tick()}reset(){cancelAnimationFrame(this.requestID)}ticker(t){this.tickerFn=t}__tick(){let t=this.beginAt,e=Date.now()-t,n=!1;if(this.option.timeline){this.axes=this.recalculation(this.timeline.getAxes());let{beginAt:i,elapsedTime:o,editing:r}=this.timeline.get(this.beginAt);t=i,e=o,n=r}this.beginAt=t,this.axes.forEach(((t,n)=>{let i=e-t.beginAt,o=Math.max(0,Math.min(i/t.duration,1)),r=t.beginAt<=e,a=t.endAt<e;t.progress=o,t.enter=r,t.pass=a})),this.option.timeline&&!n&&this.timeline.update(e,this.totalTimeForTimeline,this.axes),this.tickerFn&&this.tickerFn(e,this.toMap(this.axes)),this.requestID=requestAnimationFrame(this.__tick.bind(this))}calculation(){let t=[];for(let e=0;e<this.axes.length;e++){let n=this.axes[e],{key:i,duration:o,position:r,delay:a}=n,s=Math.max(...t.map((t=>t.endAt)))+a;void 0!==r?s=Number.isFinite(r)?r+a:this.getAxis({key:r}).endAt+a:r=s,t.push({...H,key:i,beginAt:s,endAt:s+o,duration:o,delay:a,position:r})}}recalculation(t){let e=[];for(let n=0;n<t.length;n++){let i=t[n],{key:o,duration:r,position:a,delay:s}=i,l=Math.max(...e.map((t=>t.endAt)))+s;void 0!==a?l=Number.isFinite(a)?a+s:this.getAxis({key:a}).endAt+s:a=l,e.push({...H,key:o,beginAt:l,endAt:l+r,duration:r,delay:s,position:a})}return e}sort(){this.axes.sort(((t,e)=>t.beginAt-e.beginAt))}toMap(t){let e=new Map;return t.forEach((t=>{e[t.key]=t,e.set(t.key,t)})),e}},K=1e-6,q="undefined"!=typeof Float32Array?Float32Array:Array;function G(){var t=new q(16);return q!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Y(t,e){if(t===e){var n=e[1],i=e[2],o=e[3],r=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=r,t[11]=e[14],t[12]=o,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function X(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],a=e[4],s=e[5],l=e[6],h=e[7],u=e[8],d=e[9],p=e[10],c=e[11],f=e[12],v=e[13],m=e[14],g=e[15],b=n*s-i*a,_=n*l-o*a,x=n*h-r*a,y=i*l-o*s,w=i*h-r*s,E=o*h-r*l,C=u*v-d*f,k=u*m-p*f,L=u*g-c*f,V=d*m-p*v,M=d*g-c*v,A=p*g-c*m,P=b*A-_*M+x*V+y*L-w*k+E*C;return P?(P=1/P,t[0]=(s*A-l*M+h*V)*P,t[1]=(o*M-i*A-r*V)*P,t[2]=(v*E-m*w+g*y)*P,t[3]=(p*w-d*E-c*y)*P,t[4]=(l*L-a*A-h*k)*P,t[5]=(n*A-o*L+r*k)*P,t[6]=(m*x-f*E-g*_)*P,t[7]=(u*E-p*x+c*_)*P,t[8]=(a*M-s*L+h*C)*P,t[9]=(i*L-n*M-r*C)*P,t[10]=(f*w-v*x+g*b)*P,t[11]=(d*x-u*w-c*b)*P,t[12]=(s*k-a*V-l*C)*P,t[13]=(n*V-i*k+o*C)*P,t[14]=(v*_-f*y-m*b)*P,t[15]=(u*y-d*_+p*b)*P,t):null}function W(t,e,n){var i=e[0],o=e[1],r=e[2],a=e[3],s=e[4],l=e[5],h=e[6],u=e[7],d=e[8],p=e[9],c=e[10],f=e[11],v=e[12],m=e[13],g=e[14],b=e[15],_=n[0],x=n[1],y=n[2],w=n[3];return t[0]=_*i+x*s+y*d+w*v,t[1]=_*o+x*l+y*p+w*m,t[2]=_*r+x*h+y*c+w*g,t[3]=_*a+x*u+y*f+w*b,_=n[4],x=n[5],y=n[6],w=n[7],t[4]=_*i+x*s+y*d+w*v,t[5]=_*o+x*l+y*p+w*m,t[6]=_*r+x*h+y*c+w*g,t[7]=_*a+x*u+y*f+w*b,_=n[8],x=n[9],y=n[10],w=n[11],t[8]=_*i+x*s+y*d+w*v,t[9]=_*o+x*l+y*p+w*m,t[10]=_*r+x*h+y*c+w*g,t[11]=_*a+x*u+y*f+w*b,_=n[12],x=n[13],y=n[14],w=n[15],t[12]=_*i+x*s+y*d+w*v,t[13]=_*o+x*l+y*p+w*m,t[14]=_*r+x*h+y*c+w*g,t[15]=_*a+x*u+y*f+w*b,t}function Z(t,e,n){var i,o,r,a,s,l,h,u,d,p,c,f,v=n[0],m=n[1],g=n[2];return e===t?(t[12]=e[0]*v+e[4]*m+e[8]*g+e[12],t[13]=e[1]*v+e[5]*m+e[9]*g+e[13],t[14]=e[2]*v+e[6]*m+e[10]*g+e[14],t[15]=e[3]*v+e[7]*m+e[11]*g+e[15]):(i=e[0],o=e[1],r=e[2],a=e[3],s=e[4],l=e[5],h=e[6],u=e[7],d=e[8],p=e[9],c=e[10],f=e[11],t[0]=i,t[1]=o,t[2]=r,t[3]=a,t[4]=s,t[5]=l,t[6]=h,t[7]=u,t[8]=d,t[9]=p,t[10]=c,t[11]=f,t[12]=i*v+s*m+d*g+e[12],t[13]=o*v+l*m+p*g+e[13],t[14]=r*v+h*m+c*g+e[14],t[15]=a*v+u*m+f*g+e[15]),t}function Q(t,e,n,i){var o,r,a,s,l,h,u,d,p,c,f,v,m,g,b,_,x,y,w,E,C,k,L,V,M=i[0],A=i[1],P=i[2],I=Math.hypot(M,A,P);return I<K?null:(M*=I=1/I,A*=I,P*=I,o=Math.sin(n),a=1-(r=Math.cos(n)),s=e[0],l=e[1],h=e[2],u=e[3],d=e[4],p=e[5],c=e[6],f=e[7],v=e[8],m=e[9],g=e[10],b=e[11],_=M*M*a+r,x=A*M*a+P*o,y=P*M*a-A*o,w=M*A*a-P*o,E=A*A*a+r,C=P*A*a+M*o,k=M*P*a+A*o,L=A*P*a-M*o,V=P*P*a+r,t[0]=s*_+d*x+v*y,t[1]=l*_+p*x+m*y,t[2]=h*_+c*x+g*y,t[3]=u*_+f*x+b*y,t[4]=s*w+d*E+v*C,t[5]=l*w+p*E+m*C,t[6]=h*w+c*E+g*C,t[7]=u*w+f*E+b*C,t[8]=s*k+d*L+v*V,t[9]=l*k+p*L+m*V,t[10]=h*k+c*L+g*V,t[11]=u*k+f*L+b*V,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function J(t,e,n,i,o){var r,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(r=1/(i-o),t[10]=(o+i)*r,t[14]=2*o*i*r):(t[10]=-1,t[14]=-2*i),t}function tt(t,e,n,i){var o=e[0],r=e[1],a=e[2],s=i[0],l=i[1],h=i[2],u=o-n[0],d=r-n[1],p=a-n[2],c=u*u+d*d+p*p;c>0&&(u*=c=1/Math.sqrt(c),d*=c,p*=c);var f=l*p-h*d,v=h*u-s*p,m=s*d-l*u;return(c=f*f+v*v+m*m)>0&&(f*=c=1/Math.sqrt(c),v*=c,m*=c),t[0]=f,t[1]=v,t[2]=m,t[3]=0,t[4]=d*m-p*v,t[5]=p*f-u*m,t[6]=u*v-d*f,t[7]=0,t[8]=u,t[9]=d,t[10]=p,t[11]=0,t[12]=o,t[13]=r,t[14]=a,t[15]=1,t}function et(){var t=new q(3);return q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function nt(t,e,n){var i=new q(3);return i[0]=t,i[1]=e,i[2]=n,i}function it(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function ot(t,e){var n=e[0],i=e[1],o=e[2],r=n*n+i*i+o*o;return r>0&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function rt(t,e,n){var i=n[0],o=n[1],r=n[2],a=n[3],s=e[0],l=e[1],h=e[2],u=o*h-r*l,d=r*s-i*h,p=i*l-o*s,c=o*p-r*d,f=r*u-i*p,v=i*d-o*u,m=2*a;return u*=m,d*=m,p*=m,c*=2,f*=2,v*=2,t[0]=s+u+c,t[1]=l+d+f,t[2]=h+p+v,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function at(){var t=new q(4);return q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function st(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function lt(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}et(),function(){var t,e=(t=new q(4),q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();var ht;et(),nt(1,0,0),nt(0,1,0),at(),at(),ht=new q(9),q!=Float32Array&&(ht[1]=0,ht[2]=0,ht[3]=0,ht[5]=0,ht[6]=0,ht[7]=0),ht[0]=1,ht[4]=1,ht[8]=1;const ut=(t,e)=>{const n=new Float32Array([-1*t,0,0,t,0,0,0,-1*t,0,0,t,0,0,0,t,0,0,-1*t]),i=e?[...e,...e,...e,...e,...e,...e]:[1,0,0,1,1,0,0,1,0,1,0,1,0,1,0,1,0,0,1,1,0,0,1,1];return{position:n,color:new Float32Array(i)}},dt=(t,e)=>{const n=.5*t,i=new Float32Array([-n,-n,n,n,-n,n,n,n,n,-n,n,n,-n,-n,-n,-n,n,-n,n,n,-n,n,-n,-n,-n,n,-n,-n,n,n,n,n,n,n,n,-n,-n,-n,-n,n,-n,-n,n,-n,n,-n,-n,n,n,-n,-n,n,n,-n,n,n,n,n,-n,n,-n,-n,-n,-n,-n,n,-n,n,n,-n,n,-n]);let o=1/Math.sqrt(3);const r=new Float32Array([-o,-o,o,o,-o,o,o,o,o,-o,o,o,-o,-o,-o,-o,o,-o,o,o,-o,o,-o,-o,-o,o,-o,-o,o,o,o,o,o,o,o,-o,-o,-o,-o,o,-o,-o,o,-o,o,-o,-o,o,o,-o,-o,o,o,-o,o,o,o,o,-o,o,-o,-o,-o,-o,-o,o,-o,o,o,-o,o,-o]),a=[];for(let t=0;t<i.length/3;t++)a.push(e[0],e[1],e[2],e[3]);return{position:i,normal:r,color:new Float32Array(a),indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]}},pt=(t,e,n)=>{const i=t.createProgram();if(!i)throw new Error("Failed to create program");if(t.attachShader(i,e),t.attachShader(i,n),t.linkProgram(i),t.deleteShader(e),t.deleteShader(n),!t.getProgramParameter(i,t.LINK_STATUS))throw new Error(`Failed to link: ${t.getProgramInfoLog(i)}`);return t.useProgram(i),i},ct=(t,e,n)=>{const i=t.createShader(n);if(!i)throw new Error("Failed to create shader");if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Error(`Failed to compile: ${t.getShaderInfoLog(i)}`);return i},ft=(t,e)=>{const n=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),n},vt=(t,e)=>{const n=t.createBuffer();return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Int16Array(e),t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),n},mt=(t,e,n,i)=>{e.forEach(((e,o)=>{t.bindBuffer(t.ARRAY_BUFFER,e),t.enableVertexAttribArray(n[o]),t.vertexAttribPointer(n[o],i[o],t.FLOAT,!1,0,0)}))};class gt{container;option;isMovable=!0;isScalable=!0;drag;__distance=10;scale=0;rotateX=0;rotateY=0;prevPosition;qt=at();qtx=at();qty=at();center=[0,0,0];__position=[0,7,this.__distance];defaultPosition=[0,7,this.__distance];defaultUpDirection=[0,1,0];upDirection=[0,1,0];minDistance=1;maxDistance=20;get position(){return this.__position}get distance(){return this.__distance}set distance(t){this.__distance=t}constructor(t,e){if(this.container=t,this.option=e,this.handleMousedown=this.handleMousedown.bind(this),this.handleMousemove=this.handleMousemove.bind(this),this.handleMouseup=this.handleMouseup.bind(this),this.handleWheel=this.handleWheel.bind(this),this.option&&"isMovable"in this.option&&(this.isMovable=this.option.isMovable),this.option&&"isScalable"in this.option&&(this.isScalable=this.option.isScalable),this.option&&this.option.center&&(this.center=this.option.center),this.option&&this.option.minDistance&&(this.minDistance=this.option.minDistance),this.option&&this.option.maxDistance&&(this.maxDistance=this.option.maxDistance),this.option&&this.option.position){const t=et(),e=et();ot(e,this.option.position.direction),it(t,e,this.option.position.distance),this.__distance=this.option.position.distance,this.__position=[...t],this.defaultPosition=[...t]}this.addEvent()}addEvent(){this.isMovable&&(this.container.addEventListener("mousedown",this.handleMousedown,{passive:!0}),this.container.addEventListener("mousemove",this.handleMousemove,{passive:!0}),this.container.addEventListener("mouseup",this.handleMouseup,{passive:!0})),this.isScalable&&this.container.addEventListener("wheel",this.handleWheel,{passive:!0})}removeEvent(){this.isMovable&&(this.container.removeEventListener("mousedown",this.handleMousedown),this.container.removeEventListener("mousemove",this.handleMousemove),this.container.removeEventListener("mouseup",this.handleMouseup)),this.isScalable&&this.container.removeEventListener("wheel",this.handleWheel)}handleMousedown(t){this.drag=!0;const e=this.container.getBoundingClientRect();this.prevPosition=[t.clientX-e.left,t.clientY-e.top]}handleMousemove(t){if(!0!==this.drag)return;if(1!==t.buttons)return;const e=this.container.getBoundingClientRect(),n=e.width,i=e.height,o=1/Math.min(n,i),r=t.clientX,a=t.clientY;this.rotateX+=(this.prevPosition[0]-r)*o,this.rotateY+=(this.prevPosition[1]-a)*o,this.rotateX=this.rotateX%1,this.prevPosition=[r,a]}handleMouseup(){this.drag=!1}handleWheel(t){const e=t.wheelDelta;e>0?this.scale=-.5:e<0&&(this.scale=.5)}update(){const t=2*Math.PI,e=[1,0,0];st(this.qt),st(this.qtx),st(this.qty),lt(this.qtx,[0,1,0],this.rotateX*t),rt(e,e,this.qtx),lt(this.qty,e,this.rotateY*t),function(t,e,n){var i=e[0],o=e[1],r=e[2],a=e[3],s=n[0],l=n[1],h=n[2],u=n[3];t[0]=i*u+a*s+o*h-r*l,t[1]=o*u+a*l+r*s-i*h,t[2]=r*u+a*h+i*l-o*s,t[3]=a*u-i*s-o*l-r*h}(this.qt,this.qty,this.qtx),rt(this.__position,this.defaultPosition,this.qt),rt(this.upDirection,this.defaultUpDirection,this.qt),this.scale*=.7,this.__distance+=this.scale,this.__distance=Math.min(Math.max(this.__distance,this.minDistance),this.maxDistance);const n=et();return ot(n,this.__position),it(this.__position,n,this.__distance),tt(G(),this.__position,this.center,this.upDirection)}}const bt=t=>"bool"===t?1:Number(t[t.length-1]),_t=({vertex:t,fragment:e})=>{const n=[],i=[],o={},r=/attribute (?<type>.*) (?<variable>.*);/,a=/uniform (?<type>.*) (?<variable>.*);/;return t.split("\n").forEach((t=>{const e=t.match(r);if(e){const{variable:t,type:i}=e.groups;n.push({variable:t,type:i,attStride:bt(i)})}const s=t.match(a);if(s){const{variable:t,type:e}=s.groups;i.push({variable:t,type:e}),o[t]=null}})),e.split("\n").forEach((t=>{const e=t.match(a);if(e){const{variable:t,type:n}=e.groups;i.push({variable:t,type:n}),o[t]=null}})),{attribute:n,uniform:i,uniLocation:o}};var xt="precision mediump float;\n\nvarying vec4 vColor;\n\nvoid main(){\n    gl_FragColor = vColor;\n}\n\n",yt="attribute vec3 position;\nattribute vec4 color;\nuniform mat4 mvpMatrix;\nvarying vec4 vColor;\n\n\nvoid main(){\n    vColor = color;\n\n    gl_Position = mvpMatrix * vec4(position, 1.0);\n}\n\n";const{attribute:wt,uniform:Et,uniLocation:Ct}=_t({vertex:yt,fragment:xt});"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var kt={exports:{}};kt.exports=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}var n=function(){return(n=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),o=0;for(e=0;e<n;e++)for(var r=arguments[e],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i}var o={inputs:[],monitors:[]};function r(){return i(o.inputs,o.monitors)}function a(t){return t}function s(t){return null==t}function l(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function h(t){return t&&t.parentElement&&t.parentElement.removeChild(t),null}var u="tp";function d(t){return function(e,n){return[u,"-",t,"v",e?"_"+e:"",n?"-"+n:""].join("")}}function p(){return["first","last"]}var c=d("");function f(t,e){var n=t.element;e.emitter.on("change",(function(t){if("hidden"===t.propertyName){var i=c(void 0,"hidden");e.hidden?n.classList.add(i):n.classList.remove(i)}else"positions"===t.propertyName&&(p().forEach((function(t){n.classList.remove(c(void 0,t))})),e.positions.forEach((function(t){n.classList.add(c(void 0,t))})))})),e.emitter.on("dispose",(function(){t.onDispose&&t.onDispose(),h(n)}))}var v=function(){function t(){this.observers_={}}return t.prototype.on=function(t,e){var n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this},t.prototype.off=function(t,e){var n=this.observers_[t];return n&&(this.observers_[t]=n.filter((function(t){return t.handler!==e}))),this},t.prototype.emit=function(t,e){var n=this.observers_[t];n&&n.forEach((function(t){t.handler(e)}))},t}(),m=function(){function t(t){this.emitter=new v,this.title=t}return t.prototype.click=function(){this.emitter.emit("click",{sender:this})},t}(),g=d("btn"),b=function(){function t(t,e){this.button=e.button,this.element=t.createElement("div"),this.element.classList.add(g());var n=t.createElement("button");n.classList.add(g("b")),n.textContent=this.button.title,this.element.appendChild(n),this.buttonElement=n}return t}(),_=function(){function t(t,e){this.onButtonClick_=this.onButtonClick_.bind(this),this.button=new m(e.title),this.blade=e.blade,this.view=new b(t,{button:this.button}),this.view.buttonElement.addEventListener("click",this.onButtonClick_),f(this.view,this.blade)}return t.prototype.onButtonClick_=function(){this.button.click()},t}(),x=d("lbl");function y(t,e){var n=t.createDocumentFragment();return e.split("\n").map((function(e){return t.createTextNode(e)})).forEach((function(e,i){i>0&&n.appendChild(t.createElement("br")),n.appendChild(e)})),n}var w=function(){function t(t,e){this.label=e.label,this.elem_=t.createElement("div"),this.elem_.classList.add(x());var n=t.createElement("div");n.classList.add(x("l")),n.appendChild(y(t,this.label)),this.elem_.appendChild(n);var i=t.createElement("div");i.classList.add(x("v")),i.appendChild(e.view.element),this.elem_.appendChild(i)}return Object.defineProperty(t.prototype,"element",{get:function(){return this.elem_},enumerable:!1,configurable:!0}),t}(),E=function(){function t(t,e){this.binding=e.binding,this.controller=e.controller,this.view=new w(t,{label:e.label,view:this.controller.view}),this.blade=e.blade,f(this.view,this.blade)}return t}(),C=function(){function t(t,e){var n=this;this.binding=e.binding,this.controller=e.controller,this.view=new w(t,{label:e.label,view:this.controller.view}),this.blade=e.blade,this.blade.emitter.on("dispose",(function(){n.binding.dispose()})),f(this.view,this.blade)}return t}(),k=function(){function t(){this.emitter=new v,this.disposed_=!1}return Object.defineProperty(t.prototype,"disposed",{get:function(){return this.disposed_},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){return!this.disposed_&&(this.disposed_=!0,this.emitter.emit("dispose",{sender:this}),!0)},t}(),L=function(){function t(){this.onDispose_=this.onDispose_.bind(this),this.emitter=new v,this.positions_=[],this.hidden_=!1,this.disposable_=new k,this.disposable_.emitter.on("dispose",this.onDispose_)}return Object.defineProperty(t.prototype,"hidden",{get:function(){return this.hidden_},set:function(t){this.hidden_!==t&&(this.hidden_=t,this.emitter.emit("change",{propertyName:"hidden",sender:this}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"positions",{get:function(){return this.positions_},set:function(t){l(t,this.positions_)||(this.positions_=t,this.emitter.emit("change",{propertyName:"positions",sender:this}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disposed",{get:function(){return this.disposable_.disposed},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.disposable_.dispose()},t.prototype.onDispose_=function(){this.emitter.emit("dispose",{sender:this})},t}(),V="http://www.w3.org/2000/svg";function M(t){t.offsetHeight}function A(t,e){var n=t.style.transition;t.style.transition="none",e(),t.style.transition=n}function P(t){return void 0!==t.ontouchstart}function I(){return new Function("return this")()}function S(){return a(I()).document}function F(){return"document"in I()}function R(t){return F()?t.getContext("2d"):null}var B={p2dpad:'<path d="M8 2V14" stroke="currentColor" stroke-width="1.5"/><path d="M2 8H14" stroke="currentColor" stroke-width="1.5"/><circle cx="8" cy="8" r="2" fill="currentColor"/>'};function O(t,e){var n=t.createElementNS(V,"svg");return n.innerHTML=B[e],n}function T(t,e,n){t.insertBefore(e,t.children[n])}function D(t){return t.relatedTarget?a(t.relatedTarget):"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}function N(t){var e=t.items.filter((function(t){return!t.blade.hidden})),n=e[0],i=e[e.length-1];t.items.forEach((function(t){var e=[];t===n&&e.push("first"),t===i&&e.push("last"),t.blade.positions=e}))}function $(t,e){var n=0;return A(e,(function(){t.expandedHeight=null,t.temporaryExpanded=!0,M(e),n=e.clientHeight,t.temporaryExpanded=null,M(e)})),n}var z=function(){function t(){this.emitter=new v,this.items_=[]}return Object.defineProperty(t.prototype,"items",{get:function(){return this.items_},enumerable:!1,configurable:!0}),t.prototype.add=function(t,e){var n=void 0!==e?e:this.items_.length;this.items_.splice(n,0,t),this.emitter.emit("add",{index:n,item:t,sender:this})},t.prototype.remove=function(t){var e=this.items_.indexOf(t);e<0||(this.items_.splice(e,1),this.emitter.emit("remove",{sender:this}))},t}(),j=function(){function t(){this.onItemFolderFold_=this.onItemFolderFold_.bind(this),this.onListItemLayout_=this.onListItemLayout_.bind(this),this.onSubitemLayout_=this.onSubitemLayout_.bind(this),this.onSubitemFolderFold_=this.onSubitemFolderFold_.bind(this),this.onSubitemInputChange_=this.onSubitemInputChange_.bind(this),this.onSubitemMonitorUpdate_=this.onSubitemMonitorUpdate_.bind(this),this.onItemInputChange_=this.onItemInputChange_.bind(this),this.onListAdd_=this.onListAdd_.bind(this),this.onListItemDispose_=this.onListItemDispose_.bind(this),this.onListRemove_=this.onListRemove_.bind(this),this.onItemMonitorUpdate_=this.onItemMonitorUpdate_.bind(this),this.blades_=new z,this.emitter=new v,this.blades_.emitter.on("add",this.onListAdd_),this.blades_.emitter.on("remove",this.onListRemove_)}return Object.defineProperty(t.prototype,"items",{get:function(){return this.blades_.items},enumerable:!1,configurable:!0}),t.prototype.add=function(t,e){this.blades_.add(t,e)},t.prototype.find=function(t){return this.items.reduce((function(e,n){return n instanceof q&&e.push.apply(e,n.bladeRack.find(t)),n instanceof t&&e.push(n),e}),[])},t.prototype.onListAdd_=function(t){var e=t.item;if(this.emitter.emit("add",{blade:e,index:t.index,sender:this}),e.blade.emitter.on("dispose",this.onListItemDispose_),e.blade.emitter.on("change",this.onListItemLayout_),e instanceof E)e.binding.emitter.on("change",this.onItemInputChange_);else if(e instanceof C)e.binding.emitter.on("update",this.onItemMonitorUpdate_);else if(e instanceof q){e.folder.emitter.on("change",this.onItemFolderFold_);var n=e.bladeRack.emitter;n.on("itemfold",this.onSubitemFolderFold_),n.on("itemlayout",this.onSubitemLayout_),n.on("inputchange",this.onSubitemInputChange_),n.on("monitorupdate",this.onSubitemMonitorUpdate_)}},t.prototype.onListRemove_=function(t){this.emitter.emit("remove",{sender:this})},t.prototype.onListItemLayout_=function(t){"hidden"!==t.propertyName&&"positions"!==t.propertyName||this.emitter.emit("itemlayout",{sender:this})},t.prototype.onListItemDispose_=function(t){var e=this;this.blades_.items.filter((function(t){return t.blade.disposed})).forEach((function(t){e.blades_.remove(t)}))},t.prototype.onItemInputChange_=function(t){this.emitter.emit("inputchange",{inputBinding:t.sender,sender:this,value:t.rawValue})},t.prototype.onItemMonitorUpdate_=function(t){this.emitter.emit("monitorupdate",{monitorBinding:t.sender,sender:this,value:t.rawValue})},t.prototype.onItemFolderFold_=function(t){"expanded"===t.propertyName&&this.emitter.emit("itemfold",{expanded:t.sender.expanded,sender:this})},t.prototype.onSubitemLayout_=function(t){this.emitter.emit("itemlayout",{sender:this})},t.prototype.onSubitemInputChange_=function(t){this.emitter.emit("inputchange",{inputBinding:t.inputBinding,sender:this,value:t.value})},t.prototype.onSubitemMonitorUpdate_=function(t){this.emitter.emit("monitorupdate",{monitorBinding:t.monitorBinding,sender:this,value:t.value})},t.prototype.onSubitemFolderFold_=function(t){this.emitter.emit("itemfold",{expanded:t.expanded,sender:this})},t}(),H=function(){function t(t,e){this.emitter=new v,this.expanded_=e,this.expandedHeight_=null,this.temporaryExpanded_=null,this.shouldFixHeight_=!1,this.title=t}return Object.defineProperty(t.prototype,"expanded",{get:function(){return this.expanded_},set:function(t){this.expanded_!==t&&(this.emitter.emit("beforechange",{propertyName:"expanded",sender:this}),this.expanded_=t,this.emitter.emit("change",{propertyName:"expanded",sender:this}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"temporaryExpanded",{get:function(){return this.temporaryExpanded_},set:function(t){this.temporaryExpanded_!==t&&(this.emitter.emit("beforechange",{propertyName:"temporaryExpanded",sender:this}),this.temporaryExpanded_=t,this.emitter.emit("change",{propertyName:"temporaryExpanded",sender:this}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"expandedHeight",{get:function(){return this.expandedHeight_},set:function(t){this.expandedHeight_!==t&&(this.emitter.emit("beforechange",{propertyName:"expandedHeight",sender:this}),this.expandedHeight_=t,this.emitter.emit("change",{propertyName:"expandedHeight",sender:this}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldFixHeight",{get:function(){return this.shouldFixHeight_},set:function(t){this.shouldFixHeight_!==t&&(this.emitter.emit("beforechange",{propertyName:"shouldFixHeight",sender:this}),this.shouldFixHeight_=t,this.emitter.emit("change",{propertyName:"shouldFixHeight",sender:this}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"styleExpanded",{get:function(){var t;return null!==(t=this.temporaryExpanded)&&void 0!==t?t:this.expanded},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"styleHeight",{get:function(){return this.styleExpanded?this.shouldFixHeight&&!s(this.expandedHeight)?this.expandedHeight+"px":"auto":"0"},enumerable:!1,configurable:!0}),t}(),U=d("fld"),K=function(){function t(t,e){this.onFolderChange_=this.onFolderChange_.bind(this),this.folder_=e.folder,this.folder_.emitter.on("change",this.onFolderChange_),this.element=t.createElement("div"),this.element.classList.add(U());var n=t.createElement("button");n.classList.add(U("t")),n.textContent=this.folder_.title,this.element.appendChild(n),this.titleElement=n;var i=t.createElement("div");i.classList.add(U("m")),this.titleElement.appendChild(i);var o=t.createElement("div");o.classList.add(U("c")),this.element.appendChild(o),this.containerElement=o,this.applyModel_()}return t.prototype.applyModel_=function(){var t=this.folder_.styleExpanded,e=U(void 0,"expanded");t?this.element.classList.add(e):this.element.classList.remove(e),this.containerElement.style.height=this.folder_.styleHeight},t.prototype.onFolderChange_=function(){this.applyModel_()},t}(),q=function(){function t(t,e){var n;this.onContainerTransitionEnd_=this.onContainerTransitionEnd_.bind(this),this.onFolderBeforeChange_=this.onFolderBeforeChange_.bind(this),this.onTitleClick_=this.onTitleClick_.bind(this),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackItemLayout_=this.onRackItemLayout_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.blade=e.blade,this.folder=new H(e.title,null===(n=e.expanded)||void 0===n||n),this.folder.emitter.on("beforechange",this.onFolderBeforeChange_),this.rack_=new j,this.rack_.emitter.on("add",this.onRackAdd_),this.rack_.emitter.on("itemlayout",this.onRackItemLayout_),this.rack_.emitter.on("remove",this.onRackRemove_),this.doc_=t,this.view=new K(this.doc_,{folder:this.folder}),this.view.titleElement.addEventListener("click",this.onTitleClick_),this.view.containerElement.addEventListener("transitionend",this.onContainerTransitionEnd_),f(this.view,this.blade)}return Object.defineProperty(t.prototype,"document",{get:function(){return this.doc_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bladeRack",{get:function(){return this.rack_},enumerable:!1,configurable:!0}),t.prototype.onFolderBeforeChange_=function(t){"expanded"===t.propertyName&&(s(this.folder.expandedHeight)&&(this.folder.expandedHeight=$(this.folder,this.view.containerElement)),this.folder.shouldFixHeight=!0,M(this.view.containerElement))},t.prototype.onTitleClick_=function(){this.folder.expanded=!this.folder.expanded},t.prototype.applyRackChange_=function(){N(this.bladeRack)},t.prototype.onRackAdd_=function(t){T(this.view.containerElement,t.blade.view.element,t.index),this.applyRackChange_()},t.prototype.onRackRemove_=function(t){this.applyRackChange_()},t.prototype.onRackItemLayout_=function(t){this.applyRackChange_()},t.prototype.onContainerTransitionEnd_=function(t){"height"===t.propertyName&&(this.folder.shouldFixHeight=!1,this.folder.expandedHeight=null)},t}(),G=d("spt"),Y=function(){function t(t){this.element=t.createElement("div"),this.element.classList.add(G());var e=t.createElement("hr");e.classList.add(G("r")),this.element.appendChild(e)}return t}(),X=function(){function t(t,e){this.blade=e.blade,this.view=new Y(t),f(this.view,this.blade)}return t}(),W=function(){function t(t){this.controller=t}return Object.defineProperty(t.prototype,"hidden",{get:function(){return this.controller.blade.hidden},set:function(t){this.controller.blade.hidden=t},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.controller.blade.dispose()},t.prototype.on=function(t,e){return this.controller.button.emitter.on(t,a(e.bind(this))),this},t}();function Z(t){var e=t.binding,n=t.eventName,i=t.handler;"change"===n&&e.emitter.on("change",(function(t){i(a(t.sender.target.read()))}))}function Q(t){var e=t.binding,n=t.eventName,i=t.handler;"update"===n&&e.emitter.on("update",(function(t){i(t.sender.target.read())}))}function J(t){var e=t.bladeRack,n=t.eventName,i=t.folder,o=t.handler;"change"===n&&e.emitter.on("inputchange",(function(t){o(t.inputBinding.target.read())})),"update"===n&&e.emitter.on("monitorupdate",(function(t){o(t.monitorBinding.target.read())})),"fold"===n&&(e.emitter.on("itemfold",(function(t){o(t.expanded)})),null==i||i.emitter.on("change",(function(t){"expanded"===t.propertyName&&o(t.sender.expanded)})))}var tt=function(){function t(t){this.controller=t}return Object.defineProperty(t.prototype,"hidden",{get:function(){return this.controller.blade.hidden},set:function(t){this.controller.blade.hidden=t},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.controller.blade.dispose()},t.prototype.on=function(t,e){return Z({binding:this.controller.binding,eventName:t,handler:e.bind(this)}),this},t.prototype.refresh=function(){this.controller.binding.read()},t}(),et={alreadydisposed:function(){return"View has been already disposed"},invalidparams:function(t){return"Invalid parameters for '"+t.name+"'"},nomatchingcontroller:function(t){return"No matching controller for '"+t.key+"'"},notbindable:function(){return"Value is not bindable"},propertynotfound:function(t){return"Property '"+t.name+"' not found"},shouldneverhappen:function(){return"This error should never happen"}},nt=function(){function t(t){var e;this.message=null!==(e=et[t.type](a(t.context)))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}return t.alreadyDisposed=function(){return new t({context:{},type:"alreadydisposed"})},t.notBindable=function(){return new t({context:{},type:"notbindable"})},t.propertyNotFound=function(e){return new t({type:"propertynotfound",context:{name:e}})},t.shouldNeverHappen=function(){return new t({context:{},type:"shouldneverhappen"})},t}();nt.prototype=Object.create(Error.prototype),nt.prototype.constructor=nt;var it=function(){function t(t){this.onValueChange_=this.onValueChange_.bind(this),this.reader=t.reader,this.writer=t.writer,this.emitter=new v,this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.target=t.target,this.read()}return t.prototype.read=function(){var t=this.target.read();void 0!==t&&(this.value.rawValue=this.reader(t))},t.prototype.write_=function(t){this.writer(this.target,t)},t.prototype.onValueChange_=function(t){this.write_(t.rawValue),this.emitter.emit("change",{rawValue:t.rawValue,sender:this})},t}(),ot=function(){function t(t,e){var n;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(n=null==e?void 0:e.equals)&&void 0!==n?n:function(t,e){return t===e},this.emitter=new v,this.rawValue_=t}return Object.defineProperty(t.prototype,"constraint",{get:function(){return this.constraint_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rawValue",{get:function(){return this.rawValue_},set:function(t){var e=this.constraint_?this.constraint_.constrain(t):t;!this.equals_(this.rawValue_,e)&&(this.rawValue_=e,this.emitter.emit("change",{rawValue:e,sender:this}))},enumerable:!1,configurable:!0}),t}();function rt(t,e){var n=t.binding.accept(e.target.read(),e.params);if(null===n)return null;var i={target:e.target,initialValue:n,params:e.params},o=t.binding.reader(i),r=t.binding.constraint?t.binding.constraint(i):void 0,a=new ot(o(n),{constraint:r,equals:t.binding.equals}),s=new it({reader:o,target:e.target,value:a,writer:t.binding.writer(i)}),l=t.controller({binding:s,document:e.document,initialValue:n,params:e.params});return new E(e.document,{binding:s,controller:l,label:e.params.label||e.target.key,blade:new L})}function at(t,e,n){if(s(e.read()))throw new nt({context:{key:e.key},type:"nomatchingcontroller"});var i=o.inputs.reduce((function(i,o){return i||rt(o,{document:t,target:e,params:n})}),null);if(i)return i;throw new nt({context:{key:e.key},type:"nomatchingcontroller"})}var st=function(){function t(t){this.controller=t}return Object.defineProperty(t.prototype,"hidden",{get:function(){return this.controller.blade.hidden},set:function(t){this.controller.blade.hidden=t},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.controller.blade.dispose()},t.prototype.on=function(t,e){return Q({binding:this.controller.binding,eventName:t,handler:a(e.bind(this))}),this},t.prototype.refresh=function(){this.controller.binding.read()},t}(),lt={monitor:{defaultInterval:200,defaultLineCount:3}};function ht(t,e){for(;t.length<e;)t.push(void 0)}function ut(t,e){var n=[t];return ht(n,e),new ot(n)}function dt(t){var e=t.indexOf(void 0);return a(e<0?t:t.slice(0,e))}function pt(t,e){var n=i(dt(t),[e]);return n.length>t.length?n.splice(0,n.length-t.length):ht(n,t.length),n}var ct=function(){function t(t){this.onTick_=this.onTick_.bind(this),this.reader_=t.reader,this.target=t.target,this.emitter=new v,this.value=t.value,this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}return t.prototype.dispose=function(){this.ticker.disposable.dispose()},t.prototype.read=function(){var t=this.target.read();if(void 0!==t){var e=this.value.rawValue,n=this.reader_(t);this.value.rawValue=pt(e,n),this.emitter.emit("update",{rawValue:n,sender:this})}},t.prototype.onTick_=function(t){this.read()},t}(),ft=function(){function t(t,e){var n=this;if(this.id_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new v,e<=0)this.id_=null;else{var i=this.doc_.defaultView;i&&(this.id_=i.setInterval(this.onTick_,e))}this.disposable=new k,this.disposable.emitter.on("dispose",(function(){if(null!==n.id_){var t=n.doc_.defaultView;t&&t.clearInterval(n.id_)}n.id_=null}))}return t.prototype.onTick_=function(){this.emitter.emit("tick",{sender:this})},t}(),vt=function(){function t(){this.disposable=new k,this.emitter=new v}return t.prototype.tick=function(){this.emitter.emit("tick",{sender:this})},t}();function mt(t,e){return 0===e?new vt:new ft(t,null!=e?e:lt.monitor.defaultInterval)}function gt(t,e){var n,i,o,r=t.binding.accept(e.target.read(),e.params);if(null===r)return null;var a={target:e.target,initialValue:r,params:e.params},s=t.binding.reader(a),l=null!==(o=null!==(i=null!==(n=e.params.bufferSize)&&void 0!==n?n:e.params.count)&&void 0!==i?i:t.binding.defaultBufferSize&&t.binding.defaultBufferSize(e.params))&&void 0!==o?o:1,h=new ct({reader:s,target:e.target,ticker:mt(e.document,e.params.interval),value:ut(s(r),l)});return new C(e.document,{binding:h,controller:t.controller({binding:h,document:e.document,params:e.params}),label:e.params.label||e.target.key,blade:new L})}function bt(t,e,n){var i=o.monitors.reduce((function(i,o){return i||gt(o,{document:t,params:n,target:e})}),null);if(i)return i;throw new nt({context:{key:e.key},type:"nomatchingcontroller"})}var _t=function(){function t(t){this.controller=t}return Object.defineProperty(t.prototype,"hidden",{get:function(){return this.controller.blade.hidden},set:function(t){this.controller.blade.hidden=t},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.controller.blade.dispose()},t}(),xt=function(){function t(t,e,n){this.obj_=t,this.key_=e,this.presetKey_=null!=n?n:e}return t.isBindable=function(t){return null!==t&&"object"==typeof t},Object.defineProperty(t.prototype,"key",{get:function(){return this.key_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"presetKey",{get:function(){return this.presetKey_},enumerable:!1,configurable:!0}),t.prototype.read=function(){return this.obj_[this.key_]},t.prototype.write=function(t){this.obj_[this.key_]=t},t.prototype.writeProperty=function(e,n){var i=this.read();if(!t.isBindable(i))throw nt.notBindable();if(!(e in i))throw nt.propertyNotFound(e);i[e]=n},t}();function yt(t,e,n){if(!xt.isBindable(t))throw nt.notBindable();return new xt(t,e,n)}var wt=function(){function t(t){this.controller=t}return Object.defineProperty(t.prototype,"expanded",{get:function(){return this.controller.folder.expanded},set:function(t){this.controller.folder.expanded=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hidden",{get:function(){return this.controller.blade.hidden},set:function(t){this.controller.blade.hidden=t},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.controller.blade.dispose()},t.prototype.addInput=function(t,e,n){var i=n||{},o=at(this.controller.document,yt(t,e,i.presetKey),i);return this.controller.bladeRack.add(o,i.index),new tt(a(o))},t.prototype.addMonitor=function(t,e,n){var i=n||{},o=bt(this.controller.document,yt(t,e),i);return this.controller.bladeRack.add(o,i.index),new st(a(o))},t.prototype.addFolder=function(e){var i=new q(this.controller.document,n(n({},e),{blade:new L}));return this.controller.bladeRack.add(i,e.index),new t(i)},t.prototype.addButton=function(t){var e=new _(this.controller.document,n(n({},t),{blade:new L}));return this.controller.bladeRack.add(e,t.index),new W(e)},t.prototype.addSeparator=function(t){var e=t||{},n=new X(this.controller.document,{blade:new L});return this.controller.bladeRack.add(n,e.index),new _t(n)},t.prototype.on=function(t,e){return J({eventName:t,folder:this.controller.folder,handler:a(e.bind(this)),bladeRack:this.controller.bladeRack}),this},t}();function Et(t){return t.reduce((function(t,e){var n;return Object.assign(t,((n={})[e.presetKey]=e.read(),n))}),{})}function Ct(t,e){t.forEach((function(t){var n=e[t.presetKey];void 0!==n&&t.write(n)}))}var kt=function(){function t(t){this.controller=t}return t.registerPlugin=function(t){"input"===t.type?o.inputs.unshift(t.plugin):"monitor"===t.type&&o.monitors.unshift(t.plugin)},Object.defineProperty(t.prototype,"element",{get:function(){return this.controller.view.element},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"expanded",{get:function(){var t=this.controller.folder;return!t||t.expanded},set:function(t){var e=this.controller.folder;e&&(e.expanded=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hidden",{get:function(){return this.controller.blade.hidden},set:function(t){this.controller.blade.hidden=t},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.controller.blade.dispose()},t.prototype.addInput=function(t,e,n){var i=n||{},o=at(this.controller.document,yt(t,e,i.presetKey),i);return this.controller.bladeRack.add(o,i.index),new tt(a(o))},t.prototype.addMonitor=function(t,e,n){var i=n||{},o=bt(this.controller.document,yt(t,e),i);return this.controller.bladeRack.add(o,i.index),new st(a(o))},t.prototype.addButton=function(t){var e=new _(this.controller.document,n(n({},t),{blade:new L}));return this.controller.bladeRack.add(e,t.index),new W(e)},t.prototype.addFolder=function(t){var e=new q(this.controller.document,n(n({},t),{blade:new L}));return this.controller.bladeRack.add(e,t.index),new wt(e)},t.prototype.addSeparator=function(t){var e=t||{},n=new X(this.controller.document,{blade:new L});return this.controller.bladeRack.add(n,e.index),new _t(n)},t.prototype.importPreset=function(t){Ct(this.controller.bladeRack.find(E).map((function(t){return t.binding.target})),t),this.refresh()},t.prototype.exportPreset=function(){return Et(this.controller.bladeRack.find(E).map((function(t){return t.binding.target})))},t.prototype.on=function(t,e){return J({eventName:t,folder:this.controller.folder,handler:a(e.bind(this)),bladeRack:this.controller.bladeRack}),this},t.prototype.refresh=function(){this.controller.bladeRack.find(E).forEach((function(t){t.binding.read()})),this.controller.bladeRack.find(C).forEach((function(t){t.binding.read()}))},t}(),Lt=d("rot"),Vt=function(){function t(t,e){this.titleElem_=null,this.onFolderChange_=this.onFolderChange_.bind(this),this.folder_=e.folder,this.folder_&&this.folder_.emitter.on("change",this.onFolderChange_),this.element=t.createElement("div"),this.element.classList.add(Lt());var n=this.folder_;if(n){var i=t.createElement("button");i.classList.add(Lt("t")),i.textContent=n.title,this.element.appendChild(i);var o=t.createElement("div");o.classList.add(Lt("m")),i.appendChild(o),this.titleElem_=i}var r=t.createElement("div");r.classList.add(Lt("c")),this.element.appendChild(r),this.containerElement=r,this.applyModel_()}return Object.defineProperty(t.prototype,"titleElement",{get:function(){return this.titleElem_},enumerable:!1,configurable:!0}),t.prototype.applyModel_=function(){var t=!this.folder_||this.folder_.styleExpanded,e=Lt(void 0,"expanded");t?this.element.classList.add(e):this.element.classList.remove(e),this.containerElement.style.height=this.folder_?this.folder_.styleHeight:"auto"},t.prototype.onFolderChange_=function(){this.applyModel_()},t}();function Mt(t){var e;return t.title?new H(t.title,null===(e=t.expanded)||void 0===e||e):null}var At=function(){function t(t,e){this.onContainerTransitionEnd_=this.onContainerTransitionEnd_.bind(this),this.onFolderBeforeChange_=this.onFolderBeforeChange_.bind(this),this.onTitleClick_=this.onTitleClick_.bind(this),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackItemLayout_=this.onRackItemLayout_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.folder=Mt(e),this.folder&&this.folder.emitter.on("beforechange",this.onFolderBeforeChange_),this.bladeRack=new j,this.bladeRack.emitter.on("add",this.onRackAdd_),this.bladeRack.emitter.on("itemlayout",this.onRackItemLayout_),this.bladeRack.emitter.on("remove",this.onRackRemove_),this.doc_=t,this.blade=e.blade,this.view=new Vt(this.doc_,{folder:this.folder}),this.view.titleElement&&this.view.titleElement.addEventListener("click",this.onTitleClick_),this.view.containerElement.addEventListener("transitionend",this.onContainerTransitionEnd_),f(this.view,this.blade)}return Object.defineProperty(t.prototype,"document",{get:function(){return this.doc_},enumerable:!1,configurable:!0}),t.prototype.onFolderBeforeChange_=function(t){if("expanded"===t.propertyName){var e=this.folder;e&&(s(e.expandedHeight)&&(e.expandedHeight=$(e,this.view.containerElement)),e.shouldFixHeight=!0,M(this.view.containerElement))}},t.prototype.applyRackChange_=function(){N(this.bladeRack)},t.prototype.onRackAdd_=function(t){T(this.view.containerElement,t.blade.view.element,t.index),this.applyRackChange_()},t.prototype.onRackRemove_=function(t){this.applyRackChange_()},t.prototype.onRackItemLayout_=function(t){this.applyRackChange_()},t.prototype.onTitleClick_=function(){this.folder&&(this.folder.expanded=!this.folder.expanded)},t.prototype.onContainerTransitionEnd_=function(t){"height"===t.propertyName&&this.folder&&(this.folder.shouldFixHeight=!1,this.folder.expandedHeight=null)},t}(),Pt=function(){function t(t){this.constraints_=t.constraints}return Object.defineProperty(t.prototype,"constraints",{get:function(){return this.constraints_},enumerable:!1,configurable:!0}),t.prototype.constrain=function(t){return this.constraints_.reduce((function(t,e){return e.constrain(t)}),t)},t}();function It(t,e){if(t instanceof e)return t;if(t instanceof Pt){var n=t.constraints.reduce((function(t,n){return t||(n instanceof e?n:null)}),null);if(n)return n}return null}var St=function(){function t(t){this.opts_=t.options}return Object.defineProperty(t.prototype,"options",{get:function(){return this.opts_},enumerable:!1,configurable:!0}),t.prototype.constrain=function(t){var e=this.opts_;return 0===e.length||e.filter((function(e){return e.value===t})).length>0?t:e[0].value},t}();function Ft(t){return String(t)}function Rt(t){return"false"!==t&&!!t}function Bt(t){return Ft(t)}function Ot(t,e){t.write(e)}var Tt=function(){function t(t){this.step=t.step}return t.prototype.constrain=function(t){return(t<0?-Math.round(-t/this.step):Math.round(t/this.step))*this.step},t}();function Dt(t,e,n,i,o){return i+(t-e)/(n-e)*(o-i)}function Nt(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function $t(t,e,n){return Math.min(Math.max(t,e),n)}function zt(t,e){return(t%e+e)%e}function jt(t,e){if(Array.isArray(t))return t.map((function(t){return{text:t.text,value:e(t.value)}}));var n=t;return Object.keys(n).reduce((function(t,i){return t.concat({text:i,value:e(n[i])})}),[])}function Ht(t){var e=t?It(t,St):null;return e?e.options:null}function Ut(t){var e=t?It(t,Tt):null;return e?e.step:null}function Kt(t,e){var n=t&&It(t,Tt);return n?Nt(n.step):Math.max(Nt(e),2)}function qt(t){var e=Ut(t);return null!=e?e:1}var Gt=d("lst"),Yt=function(){function t(t,e){var n=this;this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Gt()),this.stringifyValue_=e.stringifyValue;var i=t.createElement("select");i.classList.add(Gt("s")),e.options.forEach((function(e,o){var r=t.createElement("option");r.dataset.index=String(o),r.textContent=e.text,r.value=n.stringifyValue_(e.value),i.appendChild(r)})),this.element.appendChild(i),this.selectElement=i;var o=t.createElement("div");o.classList.add(Gt("m")),this.element.appendChild(o),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update()}return t.prototype.update=function(){this.selectElement.value=this.stringifyValue_(this.value.rawValue)},t.prototype.onValueChange_=function(){this.update()},t}(),Xt=function(){function t(t,e){this.onSelectChange_=this.onSelectChange_.bind(this),this.value=e.value,this.listItems_=e.listItems,this.view=new Yt(t,{options:this.listItems_,stringifyValue:e.stringifyValue,value:this.value}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}return t.prototype.onSelectChange_=function(t){var e=a(t.currentTarget).selectedOptions.item(0);if(e){var n=Number(e.dataset.index);this.value.rawValue=this.listItems_[n].value,this.view.update()}},t}(),Wt=d("ckb"),Zt=function(){function t(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Wt());var n=t.createElement("label");n.classList.add(Wt("l")),this.element.appendChild(n);var i=t.createElement("input");i.classList.add(Wt("i")),i.type="checkbox",n.appendChild(i),this.inputElement=i;var o=t.createElement("div");o.classList.add(Wt("m")),n.appendChild(o),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update()}return t.prototype.update=function(){this.inputElement.checked=this.value.rawValue},t.prototype.onValueChange_=function(){this.update()},t}(),Qt=function(){function t(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.view=new Zt(t,{value:this.value}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return t.prototype.onInputChange_=function(t){var e=a(t.currentTarget);this.value.rawValue=e.checked,this.view.update()},t}();function Jt(t){var e=[];return"options"in t&&void 0!==t.options&&e.push(new St({options:jt(t.options,Rt)})),new Pt({constraints:e})}function te(t,e){var n,i=e.constraint;return i&&It(i,St)?new Xt(t,{listItems:null!==(n=Ht(i))&&void 0!==n?n:[],stringifyValue:Ft,value:e}):new Qt(t,{value:e})}var ee={id:"input-bool",binding:{accept:function(t){return"boolean"==typeof t?t:null},constraint:function(t){return Jt(t.params)},reader:function(t){return Rt},writer:function(t){return Ot}},controller:function(t){return te(t.document,t.binding.value)}},ne=d("txt"),ie=function(){function t(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(ne());var n=t.createElement("input");n.classList.add(ne("i")),n.type="text",this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update()}return t.prototype.update=function(){this.inputElement.value=this.formatter_(this.value.rawValue)},t.prototype.onValueChange_=function(){this.update()},t}(),oe=function(){function t(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.value=e.value,this.view=new ie(t,{formatter:e.formatter,value:this.value}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return t.prototype.onInputChange_=function(t){var e=a(t.currentTarget).value,n=this.parser_(e);s(n)||(this.value.rawValue=n),this.view.update()},t}(),re=d("cswtxt"),ae=function(){function t(t,e){this.element=t.createElement("div"),this.element.classList.add(re());var n=t.createElement("div");n.classList.add(re("s")),this.swatchView_=e.swatchView,n.appendChild(this.swatchView_.element),this.element.appendChild(n);var i=t.createElement("div");i.classList.add(re("t")),this.textView=e.textView,i.appendChild(this.textView.element),this.element.appendChild(i)}return Object.defineProperty(t.prototype,"value",{get:function(){return this.textView.value},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.swatchView_.update(),this.textView.update()},t}(),se=function(){function t(t){this.onValueChange_=this.onValueChange_.bind(this),this.mode_=t.rawValue.mode,this.value=t,this.value.emitter.on("change",this.onValueChange_),this.emitter=new v}return Object.defineProperty(t.prototype,"mode",{get:function(){return this.mode_},set:function(t){this.mode_!==t&&(this.mode_=t,this.emitter.emit("change",{propertyName:"mode",sender:this}))},enumerable:!1,configurable:!0}),t.prototype.onValueChange_=function(){this.emitter.emit("change",{propertyName:"value",sender:this})},t}();function le(t){var e=parseFloat(t);return isNaN(e)?null:e}function he(t){if("number"==typeof t)return t;if("string"==typeof t){var e=le(t);if(!s(e))return e}return 0}function ue(t){return String(t)}function de(t){return function(e){return e.toFixed(Math.max(Math.min(t,20),0))}}var pe=de(0);function ce(t){return pe(t)+"%"}function fe(t,e,n){var i=$t(t/255,0,1),o=$t(e/255,0,1),r=$t(n/255,0,1),a=Math.max(i,o,r),s=Math.min(i,o,r),l=a-s,h=0,u=0,d=(s+a)/2;return 0!==l&&(u=d>.5?l/(2-s-a):l/(a+s),h=(h=i===a?(o-r)/l:o===a?2+(r-i)/l:4+(i-o)/l)/6+(h<0?1:0)),[360*h,100*u,100*d]}function ve(t,e,n){var i,o,r,a,s,l,h,u,d,p=(t%360+360)%360,c=$t(e/100,0,1),f=$t(n/100,0,1),v=(1-Math.abs(2*f-1))*c,m=v*(1-Math.abs(p/60%2-1)),g=f-v/2;return p>=0&&p<60?(h=(i=[v,m,0])[0],u=i[1],d=i[2]):p>=60&&p<120?(h=(o=[m,v,0])[0],u=o[1],d=o[2]):p>=120&&p<180?(h=(r=[0,v,m])[0],u=r[1],d=r[2]):p>=180&&p<240?(h=(a=[0,m,v])[0],u=a[1],d=a[2]):p>=240&&p<300?(h=(s=[m,0,v])[0],u=s[1],d=s[2]):(h=(l=[v,0,m])[0],u=l[1],d=l[2]),[255*(h+g),255*(u+g),255*(d+g)]}function me(t,e,n){var i=$t(t/255,0,1),o=$t(e/255,0,1),r=$t(n/255,0,1),a=Math.max(i,o,r),s=a-Math.min(i,o,r);return[0===s?0:a===i?((o-r)/s%6+6)%6*60:a===o?60*((r-i)/s+2):60*((i-o)/s+4),100*(0===a?0:s/a),100*a]}function ge(t,e,n){var i,o,r,a,s,l,h,u,d,p=zt(t,360),c=$t(e/100,0,1),f=$t(n/100,0,1),v=f*c,m=v*(1-Math.abs(p/60%2-1)),g=f-v;return p>=0&&p<60?(h=(i=[v,m,0])[0],u=i[1],d=i[2]):p>=60&&p<120?(h=(o=[m,v,0])[0],u=o[1],d=o[2]):p>=120&&p<180?(h=(r=[0,v,m])[0],u=r[1],d=r[2]):p>=180&&p<240?(h=(a=[0,m,v])[0],u=a[1],d=a[2]):p>=240&&p<300?(h=(s=[m,0,v])[0],u=s[1],d=s[2]):(h=(l=[v,0,m])[0],u=l[1],d=l[2]),[255*(h+g),255*(u+g),255*(d+g)]}function be(t){return[t[0],t[1],t[2]]}function _e(t,e){return[t[0],t[1],t[2],e]}var xe={hsl:{hsl:function(t,e,n){return[t,e,n]},hsv:function(t,e,n){var i=ve(t,e,n);return me(i[0],i[1],i[2])},rgb:ve},hsv:{hsl:function(t,e,n){var i=ge(t,e,n);return fe(i[0],i[1],i[2])},hsv:function(t,e,n){return[t,e,n]},rgb:ge},rgb:{hsl:fe,hsv:me,rgb:function(t,e,n){return[t,e,n]}}};function ye(t,e,n){var i;return(i=xe[e])[n].apply(i,t)}var we={hsl:function(t){var e;return[zt(t[0],360),$t(t[1],0,100),$t(t[2],0,100),$t(null!==(e=t[3])&&void 0!==e?e:1,0,1)]},hsv:function(t){var e;return[zt(t[0],360),$t(t[1],0,100),$t(t[2],0,100),$t(null!==(e=t[3])&&void 0!==e?e:1,0,1)]},rgb:function(t){var e;return[$t(t[0],0,255),$t(t[1],0,255),$t(t[2],0,255),$t(null!==(e=t[3])&&void 0!==e?e:1,0,1)]}};function Ee(t,e){return"object"==typeof t&&!s(t)&&e in t&&"number"==typeof t[e]}var Ce=function(){function t(t,e){this.mode_=e,this.comps_=we[e](t)}return t.black=function(){return new t([0,0,0],"rgb")},t.fromObject=function(e){return new t("a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b],"rgb")},t.toRgbaObject=function(t){return t.toRgbaObject()},t.isRgbColorObject=function(t){return Ee(t,"r")&&Ee(t,"g")&&Ee(t,"b")},t.isRgbaColorObject=function(t){return this.isRgbColorObject(t)&&Ee(t,"a")},t.isColorObject=function(t){return this.isRgbColorObject(t)},t.equals=function(t,e){if(t.mode_!==e.mode_)return!1;for(var n=t.comps_,i=e.comps_,o=0;o<n.length;o++)if(n[o]!==i[o])return!1;return!0},Object.defineProperty(t.prototype,"mode",{get:function(){return this.mode_},enumerable:!1,configurable:!0}),t.prototype.getComponents=function(t){return _e(ye(be(this.comps_),this.mode_,t||this.mode_),this.comps_[3])},t.prototype.toRgbaObject=function(){var t=this.getComponents("rgb");return{r:t[0],g:t[1],b:t[2],a:t[3]}},t}();function ke(t,e){var n=t.match(/^(.+)%$/);return n?Math.min(.01*parseFloat(n[1])*e,e):Math.min(parseFloat(t),e)}var Le={deg:function(t){return t},grad:function(t){return 360*t/400},rad:function(t){return 360*t/(2*Math.PI)},turn:function(t){return 360*t}};function Ve(t){var e=t.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(t);var n=parseFloat(e[1]),i=e[2];return Le[i](n)}var Me={"func.rgb":function(t){var e=t.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[ke(e[1],255),ke(e[2],255),ke(e[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:new Ce(n,"rgb")},"func.rgba":function(t){var e=t.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[ke(e[1],255),ke(e[2],255),ke(e[3],255),ke(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:new Ce(n,"rgb")},"func.hsl":function(t){var e=t.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[Ve(e[1]),ke(e[2],100),ke(e[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:new Ce(n,"hsl")},"func.hsla":function(t){var e=t.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[Ve(e[1]),ke(e[2],100),ke(e[3],100),ke(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:new Ce(n,"hsl")},"hex.rgb":function(t){var e=t.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return new Ce([parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)],"rgb");var n=t.match(/^#([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?new Ce([parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)],"rgb"):null},"hex.rgba":function(t){var e=t.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return new Ce([parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),Dt(parseInt(e[4]+e[4],16),0,255,0,1)],"rgb");var n=t.match(/^#?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?new Ce([parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),Dt(parseInt(n[4],16),0,255,0,1)],"rgb"):null}};function Ae(t){return Object.keys(Me).reduce((function(e,n){return e||((0,Me[n])(t)?n:null)}),null)}var Pe=function(t){var e=Ae(t);return e?Me[e](t):null};function Ie(t){return"func.hsla"===t||"func.rgba"===t||"hex.rgba"===t}function Se(t){if("string"==typeof t){var e=Pe(t);if(e)return e}return Ce.black()}function Fe(t){var e=$t(Math.floor(t),0,255).toString(16);return 1===e.length?"0"+e:e}function Re(t){return"#"+be(t.getComponents("rgb")).map(Fe).join("")}function Be(t){var e=t.getComponents("rgb");return"#"+[e[0],e[1],e[2],255*e[3]].map(Fe).join("")}function Oe(t){var e=de(0);return"rgb("+be(t.getComponents("rgb")).map((function(t){return e(t)})).join(", ")+")"}function Te(t){var e=de(2),n=de(0);return"rgba("+t.getComponents("rgb").map((function(t,i){return(3===i?e:n)(t)})).join(", ")+")"}function De(t){var e=[de(0),ce,ce];return"hsl("+be(t.getComponents("hsl")).map((function(t,n){return e[n](t)})).join(", ")+")"}function Ne(t){var e=[de(0),ce,ce,de(2)];return"hsla("+t.getComponents("hsl").map((function(t,n){return e[n](t)})).join(", ")+")"}var $e={"func.hsl":De,"func.hsla":Ne,"func.rgb":Oe,"func.rgba":Te,"hex.rgb":Re,"hex.rgba":Be};function ze(t){return $e[t]}var je=d("csw"),He=function(){function t(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(je());var n=t.createElement("div");n.classList.add(je("sw")),this.element.appendChild(n),this.swatchElem_=n;var i=t.createElement("button");i.classList.add(je("b")),this.element.appendChild(i),this.buttonElement=i;var o=t.createElement("div");o.classList.add(je("p")),this.pickerView_=e.pickerView,o.appendChild(this.pickerView_.element),this.element.appendChild(o),this.update()}return t.prototype.update=function(){var t=this.value.rawValue;this.swatchElem_.style.backgroundColor=Be(t)},t.prototype.onValueChange_=function(){this.update()},t}(),Ue=function(){function t(){this.emitter=new v,this.expanded_=!1}return Object.defineProperty(t.prototype,"expanded",{get:function(){return this.expanded_},set:function(t){this.expanded_!==t&&(this.expanded_=t,this.emitter.emit("change",{sender:this}))},enumerable:!1,configurable:!0}),t}();function Ke(t){var e=t.primary,n=t.secondary,i=t.forward,o=t.backward;e.emitter.on("change",(function(){n.rawValue=i(e,n)})),n.emitter.on("change",(function(){e.rawValue=o(e,n)})),n.rawValue=i(e,n)}function qe(t,e){var n=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+n:e.downKey?-n:0}function Ge(t){return{altKey:t.altKey,downKey:40===t.keyCode,shiftKey:t.shiftKey,upKey:38===t.keyCode}}function Ye(t){return{altKey:t.altKey,downKey:37===t.keyCode,shiftKey:t.shiftKey,upKey:39===t.keyCode}}function Xe(t){return 38===t||40===t}function We(t){return Xe(t)||37===t||39===t}var Ze=function(t){function n(e,n){var i=t.call(this,e,n)||this;return i.onInputKeyDown_=i.onInputKeyDown_.bind(i),i.baseStep_=n.baseStep,i.view.inputElement.addEventListener("keydown",i.onInputKeyDown_),i}return e(n,t),n.prototype.onInputKeyDown_=function(t){var e=qe(this.baseStep_,Ge(t));0!==e&&(this.value.rawValue+=e,this.view.update())},n}(oe),Qe=d("clp"),Je=function(){function t(t,e){this.alphaViews_=null,this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.pickedColor=e.pickedColor,this.pickedColor.value.emitter.on("change",this.onValueChange_),this.foldable=e.foldable,this.foldable.emitter.on("change",this.onFoldableChange_),this.element=t.createElement("div"),this.element.classList.add(Qe());var n=t.createElement("div");n.classList.add(Qe("hsv"));var i=t.createElement("div");i.classList.add(Qe("sv")),this.svPaletteView_=e.svPaletteView,i.appendChild(this.svPaletteView_.element),n.appendChild(i);var o=t.createElement("div");o.classList.add(Qe("h")),this.hPaletteView_=e.hPaletteView,o.appendChild(this.hPaletteView_.element),n.appendChild(o),this.element.appendChild(n);var r=t.createElement("div");if(r.classList.add(Qe("rgb")),this.compTextsView_=e.componentTextsView,r.appendChild(this.compTextsView_.element),this.element.appendChild(r),e.alphaViews){this.alphaViews_={palette:e.alphaViews.palette,text:e.alphaViews.text};var a=t.createElement("div");a.classList.add(Qe("a"));var s=t.createElement("div");s.classList.add(Qe("ap")),s.appendChild(this.alphaViews_.palette.element),a.appendChild(s);var l=t.createElement("div");l.classList.add(Qe("at")),l.appendChild(this.alphaViews_.text.element),a.appendChild(l),this.element.appendChild(a)}this.update()}return Object.defineProperty(t.prototype,"allFocusableElements",{get:function(){var t=i([this.svPaletteView_.element,this.hPaletteView_.element],this.compTextsView_.inputElements);return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),a(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.pickedColor.value},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.foldable.expanded?this.element.classList.add(Qe(void 0,"expanded")):this.element.classList.remove(Qe(void 0,"expanded"))},t.prototype.onValueChange_=function(){this.update()},t.prototype.onFoldableChange_=function(){this.update()},t}();function tn(t,e){var n=e.ownerDocument.defaultView,i=e.getBoundingClientRect();return[t.pageX-((n&&n.scrollX||0)+i.left),t.pageY-((n&&n.scrollY||0)+i.top)]}var en=function(){function t(t,e){this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.document=t,this.element=e,this.emitter=new v,this.pressed_=!1,P(this.document)?(e.addEventListener("touchstart",this.onTouchStart_),e.addEventListener("touchmove",this.onTouchMove_)):(e.addEventListener("mousedown",this.onMouseDown_),this.document.addEventListener("mousemove",this.onDocumentMouseMove_),this.document.addEventListener("mouseup",this.onDocumentMouseUp_))}return t.prototype.computePosition_=function(t,e){var n=this.element.getBoundingClientRect();return{px:t/n.width,py:e/n.height}},t.prototype.onMouseDown_=function(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus(),this.pressed_=!0,this.emitter.emit("down",{data:this.computePosition_.apply(this,tn(t,this.element)),sender:this})},t.prototype.onDocumentMouseMove_=function(t){this.pressed_&&this.emitter.emit("move",{data:this.computePosition_.apply(this,tn(t,this.element)),sender:this})},t.prototype.onDocumentMouseUp_=function(t){this.pressed_&&(this.pressed_=!1,this.emitter.emit("up",{data:this.computePosition_.apply(this,tn(t,this.element)),sender:this}))},t.prototype.onTouchStart_=function(t){t.preventDefault();var e=t.targetTouches[0],n=this.element.getBoundingClientRect();this.emitter.emit("down",{data:this.computePosition_(e.clientX-n.left,e.clientY-n.top),sender:this})},t.prototype.onTouchMove_=function(t){var e=t.targetTouches[0],n=this.element.getBoundingClientRect();this.emitter.emit("move",{data:this.computePosition_(e.clientX-n.left,e.clientY-n.top),sender:this})},t}();function nn(t){return t?.1:1}var on=d("apl"),rn=function(){function t(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(on()),this.element.tabIndex=0;var n=t.createElement("div");n.classList.add(on("b")),this.element.appendChild(n);var i=t.createElement("div");i.classList.add(on("c")),n.appendChild(i),this.colorElem_=i;var o=t.createElement("div");o.classList.add(on("m")),this.element.appendChild(o),this.markerElem_=o;var r=t.createElement("div");r.classList.add(on("p")),this.markerElem_.appendChild(r),this.previewElem_=r,this.update()}return t.prototype.update=function(){var t=this.value.rawValue,e=t.getComponents("rgb"),n=new Ce([e[0],e[1],e[2],0],"rgb"),i=new Ce([e[0],e[1],e[2],255],"rgb"),o=["to right",Te(n),Te(i)];this.colorElem_.style.background="linear-gradient("+o.join(",")+")",this.previewElem_.style.backgroundColor=Te(t);var r=Dt(e[3],0,1,0,100);this.markerElem_.style.left=r+"%"},t.prototype.onValueChange_=function(){this.update()},t}(),an=function(){function t(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.view=new rn(t,{value:this.value}),this.ptHandler_=new en(t,this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_)}return t.prototype.handlePointerEvent_=function(t){var e=t.px,n=this.value.rawValue.getComponents("hsv"),i=n[0],o=n[1],r=n[2];this.value.rawValue=new Ce([i,o,r,e],"hsv"),this.view.update()},t.prototype.onPointerDown_=function(t){this.handlePointerEvent_(t.data)},t.prototype.onPointerMove_=function(t){this.handlePointerEvent_(t.data)},t.prototype.onPointerUp_=function(t){this.handlePointerEvent_(t.data)},t.prototype.onKeyDown_=function(t){var e=qe(nn(!0),Ye(t)),n=this.value.rawValue.getComponents("hsv"),i=n[0],o=n[1],r=n[2],a=n[3];this.value.rawValue=new Ce([i,o,r,a+e],"hsv")},t}(),sn=d("cctxts"),ln=de(0);function hn(t){var e=t.createElement("select"),n=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return e.appendChild(n.reduce((function(e,n){var i=t.createElement("option");return i.textContent=n.text,i.value=n.value,e.appendChild(i),e}),t.createDocumentFragment())),e}var un=function(){function t(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(sn());var n=t.createElement("div");n.classList.add(sn("m")),this.modeElem_=hn(t),this.modeElem_.classList.add(sn("ms")),n.appendChild(this.modeSelectElement);var i=t.createElement("div");i.classList.add(sn("mm")),n.appendChild(i),this.element.appendChild(n);var o=t.createElement("div");o.classList.add(sn("w")),this.element.appendChild(o);var r=[0,1,2].map((function(){var e=t.createElement("input");return e.classList.add(sn("i")),e.type="text",e}));r.forEach((function(t){o.appendChild(t)})),this.inputElems_=[r[0],r[1],r[2]],this.pickedColor=e.pickedColor,this.pickedColor.emitter.on("change",this.onValueChange_),this.update()}return Object.defineProperty(t.prototype,"modeSelectElement",{get:function(){return this.modeElem_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputElements",{get:function(){return this.inputElems_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.pickedColor.value},enumerable:!1,configurable:!0}),t.prototype.update=function(){var t=this;this.modeElem_.value=this.pickedColor.mode,this.pickedColor.value.rawValue.getComponents(this.pickedColor.mode).forEach((function(e,n){var i=t.inputElems_[n];i&&(i.value=ln(e))}))},t.prototype.onValueChange_=function(){this.update()},t}(),dn=function(){function t(t,e){var n=this;this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.parser_=e.parser,this.pickedColor=e.pickedColor,this.view=new un(t,{pickedColor:this.pickedColor}),this.view.inputElements.forEach((function(t){t.addEventListener("change",n.onInputChange_),t.addEventListener("keydown",n.onInputKeyDown_)})),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}return Object.defineProperty(t.prototype,"value",{get:function(){return this.pickedColor.value},enumerable:!1,configurable:!0}),t.prototype.findIndexOfInputElem_=function(t){for(var e=this.view.inputElements,n=0;n<e.length;n++)if(e[n]===t)return n;return null},t.prototype.updateComponent_=function(t,e){var n=this.pickedColor.mode,i=this.value.rawValue.getComponents(n).map((function(n,i){return i===t?e:n}));this.value.rawValue=new Ce(i,n),this.view.update()},t.prototype.onInputChange_=function(t){var e=a(t.currentTarget),n=this.parser_(e.value);if(!s(n)){var i=this.findIndexOfInputElem_(e);s(i)||this.updateComponent_(i,n)}},t.prototype.onInputKeyDown_=function(t){var e=this.findIndexOfInputElem_(t.currentTarget),n=qe(nn(3===e),Ge(t));if(0!==n){var i=a(t.currentTarget),o=this.parser_(i.value);s(o)||s(e)||this.updateComponent_(e,o+n)}},t.prototype.onModeSelectChange_=function(t){var e=t.currentTarget;this.pickedColor.mode=e.value},t}(),pn=d("hpl"),cn=function(){function t(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(pn()),this.element.tabIndex=0;var n=t.createElement("div");n.classList.add(pn("c")),this.element.appendChild(n);var i=t.createElement("div");i.classList.add(pn("m")),this.element.appendChild(i),this.markerElem_=i,this.update()}return t.prototype.update=function(){var t=this.value.rawValue.getComponents("hsv")[0];this.markerElem_.style.backgroundColor=Oe(new Ce([t,100,100],"hsv"));var e=Dt(t,0,360,0,100);this.markerElem_.style.left=e+"%"},t.prototype.onValueChange_=function(){this.update()},t}(),fn=function(){function t(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.view=new cn(t,{value:this.value}),this.ptHandler_=new en(t,this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_)}return t.prototype.handlePointerEvent_=function(t){var e=Dt(t.px,0,1,0,360),n=this.value.rawValue.getComponents("hsv"),i=n[1],o=n[2],r=n[3];this.value.rawValue=new Ce([e,i,o,r],"hsv"),this.view.update()},t.prototype.onPointerDown_=function(t){this.handlePointerEvent_(t.data)},t.prototype.onPointerMove_=function(t){this.handlePointerEvent_(t.data)},t.prototype.onPointerUp_=function(t){this.handlePointerEvent_(t.data)},t.prototype.onKeyDown_=function(t){var e=qe(nn(!1),Ye(t)),n=this.value.rawValue.getComponents("hsv"),i=n[0],o=n[1],r=n[2],a=n[3];this.value.rawValue=new Ce([i+e,o,r,a],"hsv")},t}(),vn=d("svp"),mn=64,gn=function(){function t(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(vn()),this.element.tabIndex=0;var n=t.createElement("canvas");n.height=mn,n.width=mn,n.classList.add(vn("c")),this.element.appendChild(n),this.canvasElement=n;var i=t.createElement("div");i.classList.add(vn("m")),this.element.appendChild(i),this.markerElem_=i,this.update()}return t.prototype.update=function(){var t=R(this.canvasElement);if(t){for(var e=this.value.rawValue.getComponents("hsv"),n=this.canvasElement.width,i=this.canvasElement.height,o=t.getImageData(0,0,n,i),r=o.data,a=0;a<i;a++)for(var s=0;s<n;s++){var l=Dt(s,0,n,0,100),h=Dt(a,0,i,100,0),u=ge(e[0],l,h),d=4*(a*n+s);r[d]=u[0],r[d+1]=u[1],r[d+2]=u[2],r[d+3]=255}t.putImageData(o,0,0);var p=Dt(e[1],0,100,0,100);this.markerElem_.style.left=p+"%";var c=Dt(e[2],0,100,100,0);this.markerElem_.style.top=c+"%"}},t.prototype.onValueChange_=function(){this.update()},t}(),bn=function(){function t(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.view=new gn(t,{value:this.value}),this.ptHandler_=new en(t,this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_)}return t.prototype.handlePointerEvent_=function(t){var e=Dt(t.px,0,1,0,100),n=Dt(t.py,0,1,100,0),i=this.value.rawValue.getComponents("hsv"),o=i[0],r=i[3];this.value.rawValue=new Ce([o,e,n,r],"hsv"),this.view.update()},t.prototype.onPointerDown_=function(t){this.handlePointerEvent_(t.data)},t.prototype.onPointerMove_=function(t){this.handlePointerEvent_(t.data)},t.prototype.onPointerUp_=function(t){this.handlePointerEvent_(t.data)},t.prototype.onKeyDown_=function(t){We(t.keyCode)&&t.preventDefault();var e=this.value.rawValue.getComponents("hsv"),n=e[0],i=e[1],o=e[2],r=e[3],a=nn(!1);this.value.rawValue=new Ce([n,i+qe(a,Ye(t)),o+qe(a,Ge(t)),r],"hsv")},t}(),_n=function(){function t(t,e){var n=this;this.triggerElement=null,this.onFocusableElementBlur_=this.onFocusableElementBlur_.bind(this),this.onKeyDown_=this.onKeyDown_.bind(this),this.pickedColor=e.pickedColor,this.foldable=new Ue,this.hPaletteIc_=new fn(t,{value:this.pickedColor.value}),this.svPaletteIc_=new bn(t,{value:this.pickedColor.value}),this.alphaIcs_=e.supportsAlpha?{palette:new an(t,{value:this.pickedColor.value}),text:new Ze(t,{formatter:de(2),parser:le,baseStep:.1,value:new ot(0)})}:null,this.alphaIcs_&&Ke({primary:this.pickedColor.value,secondary:this.alphaIcs_.text.value,forward:function(t){return t.rawValue.getComponents()[3]},backward:function(t,e){var n=t.rawValue.getComponents();return n[3]=e.rawValue,new Ce(n,t.rawValue.mode)}}),this.compTextsIc_=new dn(t,{parser:le,pickedColor:this.pickedColor}),this.view=new Je(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,componentTextsView:this.compTextsIc_.view,foldable:this.foldable,hPaletteView:this.hPaletteIc_.view,pickedColor:this.pickedColor,supportsAlpha:e.supportsAlpha,svPaletteView:this.svPaletteIc_.view}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.allFocusableElements.forEach((function(t){t.addEventListener("blur",n.onFocusableElementBlur_)}))}return Object.defineProperty(t.prototype,"value",{get:function(){return this.pickedColor.value},enumerable:!1,configurable:!0}),t.prototype.onFocusableElementBlur_=function(t){var e=this.view.element,n=D(t);n&&e.contains(n)||n&&n===this.triggerElement&&!P(e.ownerDocument)||(this.foldable.expanded=!1)},t.prototype.onKeyDown_=function(t){27===t.keyCode&&(this.foldable.expanded=!1)},t}(),xn=function(){function t(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.value=e.value,this.pickerIc_=new _n(t,{pickedColor:new se(this.value),supportsAlpha:e.supportsAlpha}),this.view=new He(t,{pickerView:this.pickerIc_.view,value:this.value}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.pickerIc_.triggerElement=this.view.buttonElement}return t.prototype.onButtonBlur_=function(t){var e=this.view.element,n=a(t.relatedTarget);n&&e.contains(n)||(this.pickerIc_.foldable.expanded=!1)},t.prototype.onButtonClick_=function(){this.pickerIc_.foldable.expanded=!this.pickerIc_.foldable.expanded,this.pickerIc_.foldable.expanded&&this.pickerIc_.view.allFocusableElements[0].focus()},t}(),yn=function(){function t(t,e){this.value=e.value,this.swatchIc_=new xn(t,{supportsAlpha:e.supportsAlpha,value:this.value}),this.textIc_=new oe(t,{formatter:e.formatter,parser:e.parser,value:this.value}),this.view=new ae(t,{swatchView:this.swatchIc_.view,textView:this.textIc_.view})}return t}();function wn(t){return Ce.isColorObject(t)?Ce.fromObject(t):Ce.black()}function En(t){return be(t.getComponents("rgb")).reduce((function(t,e){return t<<8|255&Math.floor(e)}),0)}function Cn(t){return t.getComponents("rgb").reduce((function(t,e,n){return t<<8|255&Math.floor(3===n?255*e:e)}),0)>>>0}function kn(t){return new Ce([t>>16&255,t>>8&255,255&t],"rgb")}function Ln(t){return new Ce([t>>24&255,t>>16&255,t>>8&255,Dt(255&t,0,255,0,1)],"rgb")}function Vn(t){return"number"!=typeof t?Ce.black():kn(t)}function Mn(t){return"number"!=typeof t?Ce.black():Ln(t)}function An(t){var e=ze(t);return function(t,n){Ot(t,e(n))}}function Pn(t){var e=t?Cn:En;return function(t,n){Ot(t,e(n))}}function In(t,e){var n=e.toRgbaObject();t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b),t.writeProperty("a",n.a)}function Sn(t,e){var n=e.toRgbaObject();t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b)}function Fn(t){return t?In:Sn}function Rn(t){return"input"in t&&"color.rgba"===t.input}var Bn={id:"input-color-number",binding:{accept:function(t,e){return"number"!=typeof t?null:"input"in e?"color"!==e.input&&"color.rgb"!==e.input&&"color.rgba"!==e.input?null:t:null},reader:function(t){return Rn(t.params)?Mn:Vn},writer:function(t){return Pn(Rn(t.params))},equals:Ce.equals},controller:function(t){var e=Rn(t.params),n=e?Be:Re;return new yn(t.document,{formatter:n,parser:Pe,supportsAlpha:e,value:t.binding.value})}};function On(t){return Ce.isRgbaColorObject(t)}var Tn={id:"input-color-object",binding:{accept:function(t,e){return Ce.isColorObject(t)?t:null},reader:function(t){return wn},writer:function(t){return Fn(On(t.initialValue))},equals:Ce.equals},controller:function(t){var e=Ce.isRgbaColorObject(t.initialValue),n=e?Be:Re;return new yn(t.document,{formatter:n,parser:Pe,supportsAlpha:e,value:t.binding.value})}},Dn={id:"input-color-string",binding:{accept:function(t,e){return"string"!=typeof t||"input"in e&&"string"===e.input?null:Ae(t)?t:null},reader:function(t){return Se},writer:function(t){var e=Ae(t.initialValue);if(!e)throw nt.shouldNeverHappen();return An(e)},equals:Ce.equals},controller:function(t){var e=Ae(t.initialValue);if(!e)throw nt.shouldNeverHappen();var n=ze(e);return new yn(t.document,{formatter:n,parser:Pe,supportsAlpha:Ie(e),value:t.binding.value})}},Nn=function(){function t(t){this.maxValue=t.max,this.minValue=t.min}return t.prototype.constrain=function(t){var e=t;return s(this.minValue)||(e=Math.max(e,this.minValue)),s(this.maxValue)||(e=Math.min(e,this.maxValue)),e},t}(),$n=d("sldtxt"),zn=function(){function t(t,e){this.element=t.createElement("div"),this.element.classList.add($n());var n=t.createElement("div");n.classList.add($n("s")),this.sliderView_=e.sliderView,n.appendChild(this.sliderView_.element),this.element.appendChild(n);var i=t.createElement("div");i.classList.add($n("t")),this.textView_=e.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)}return Object.defineProperty(t.prototype,"value",{get:function(){return this.sliderView_.value},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.sliderView_.update(),this.textView_.update()},t}(),jn=d("sld"),Hn=function(){function t(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.minValue_=e.minValue,this.maxValue_=e.maxValue,this.element=t.createElement("div"),this.element.classList.add(jn());var n=t.createElement("div");n.classList.add(jn("o")),n.tabIndex=0,this.element.appendChild(n),this.outerElement=n;var i=t.createElement("div");i.classList.add(jn("i")),this.outerElement.appendChild(i),this.innerElement=i,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update()}return t.prototype.update=function(){var t=$t(Dt(this.value.rawValue,this.minValue_,this.maxValue_,0,100),0,100);this.innerElement.style.width=t+"%"},t.prototype.onValueChange_=function(){this.update()},t}();function Un(t){var e=t.constraint?It(t.constraint,Nn):null;return e?[e.minValue,e.maxValue]:[void 0,void 0]}function Kn(t){var e=Un(t),n=e[0],i=e[1];return[null!=n?n:0,null!=i?i:100]}var qn=function(){function t(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.baseStep_=e.baseStep;var n=Kn(this.value),i=n[0],o=n[1];this.minValue_=i,this.maxValue_=o,this.view=new Hn(t,{maxValue:this.maxValue_,minValue:this.minValue_,value:this.value}),this.ptHandler_=new en(t,this.view.outerElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.outerElement.addEventListener("keydown",this.onKeyDown_)}return t.prototype.handlePointerEvent_=function(t){this.value.rawValue=Dt(t.px,0,1,this.minValue_,this.maxValue_)},t.prototype.onPointerDown_=function(t){this.handlePointerEvent_(t.data)},t.prototype.onPointerMove_=function(t){this.handlePointerEvent_(t.data)},t.prototype.onPointerUp_=function(t){this.handlePointerEvent_(t.data)},t.prototype.onKeyDown_=function(t){this.value.rawValue+=qe(this.baseStep_,Ye(t))},t}(),Gn=function(){function t(t,e){this.value=e.value,this.sliderIc_=new qn(t,{baseStep:e.baseStep,value:e.value}),this.textIc_=new Ze(t,{baseStep:e.baseStep,formatter:e.formatter,parser:e.parser,value:e.value}),this.view=new zn(t,{sliderView:this.sliderIc_.view,textView:this.textIc_.view})}return t}();function Yn(t){var e=[];return"step"in t&&!s(t.step)&&e.push(new Tt({step:t.step})),("max"in t&&!s(t.max)||"min"in t&&!s(t.min))&&e.push(new Nn({max:t.max,min:t.min})),"options"in t&&void 0!==t.options&&e.push(new St({options:jt(t.options,he)})),new Pt({constraints:e})}function Xn(t,e){var n,i=e.constraint;return i&&It(i,St)?new Xt(t,{listItems:null!==(n=Ht(i))&&void 0!==n?n:[],stringifyValue:ue,value:e}):i&&It(i,Nn)?new Gn(t,{baseStep:qt(i),formatter:de(Kt(e.constraint,e.rawValue)),parser:le,value:e}):new Ze(t,{baseStep:qt(i),formatter:de(Kt(e.constraint,e.rawValue)),parser:le,value:e})}var Wn={id:"input-number",binding:{accept:function(t){return"number"==typeof t?t:null},constraint:function(t){return Yn(t.params)},reader:function(t){return he},writer:function(t){return Ot}},controller:function(t){return Xn(t.document,t.binding.value)}},Zn=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.getComponents=function(){return[this.x,this.y]},t.isObject=function(t){if(s(t))return!1;var e=t.x,n=t.y;return"number"==typeof e&&"number"==typeof n},t.equals=function(t,e){return t.x===e.x&&t.y===e.y},t.prototype.toObject=function(){return{x:this.x,y:this.y}},t}(),Qn=function(){function t(t){this.x=t.x,this.y=t.y}return t.prototype.constrain=function(t){return new Zn(this.x?this.x.constrain(t.x):t.x,this.y?this.y.constrain(t.y):t.y)},t}(),Jn=d("p2dpadtxt"),ti=function(){function t(t,e){this.element=t.createElement("div"),this.element.classList.add(Jn());var n=t.createElement("div");n.classList.add(Jn("w")),this.element.appendChild(n);var i=t.createElement("button");i.classList.add(Jn("b")),i.appendChild(O(t,"p2dpad")),n.appendChild(i),this.padButtonElem_=i;var o=t.createElement("div");o.classList.add(Jn("p")),n.appendChild(o),this.padView_=e.padView,o.appendChild(this.padView_.element);var r=t.createElement("div");r.classList.add(Jn("t")),this.textView_=e.textView,r.appendChild(this.textView_.element),this.element.appendChild(r)}return Object.defineProperty(t.prototype,"value",{get:function(){return this.textView_.value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padButtonElement",{get:function(){return this.padButtonElem_},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.padView_.update(),this.textView_.update()},t}(),ei=d("p2dpad"),ni=function(){function t(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.foldable=e.foldable,this.foldable.emitter.on("change",this.onFoldableChange_),this.invertsY_=e.invertsY,this.maxValue_=e.maxValue,this.element=t.createElement("div"),this.element.classList.add(ei());var n=t.createElement("div");n.tabIndex=0,n.classList.add(ei("p")),this.element.appendChild(n),this.padElement=n;var i=t.createElementNS(V,"svg");i.classList.add(ei("g")),this.padElement.appendChild(i),this.svgElem_=i;var o=t.createElementNS(V,"line");o.classList.add(ei("ax")),o.setAttributeNS(null,"x1","0"),o.setAttributeNS(null,"y1","50%"),o.setAttributeNS(null,"x2","100%"),o.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(o);var r=t.createElementNS(V,"line");r.classList.add(ei("ax")),r.setAttributeNS(null,"x1","50%"),r.setAttributeNS(null,"y1","0"),r.setAttributeNS(null,"x2","50%"),r.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(r);var a=t.createElementNS(V,"line");a.classList.add(ei("l")),a.setAttributeNS(null,"x1","50%"),a.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(a),this.lineElem_=a;var s=t.createElementNS(V,"circle");s.classList.add(ei("m")),s.setAttributeNS(null,"r","2px"),this.svgElem_.appendChild(s),this.markerElem_=s,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update()}return Object.defineProperty(t.prototype,"allFocusableElements",{get:function(){return[this.padElement]},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.foldable.expanded?this.element.classList.add(ei(void 0,"expanded")):this.element.classList.remove(ei(void 0,"expanded"));var t=this.value.rawValue.getComponents(),e=t[0],n=t[1],i=this.maxValue_,o=Dt(e,-i,+i,0,100),r=Dt(n,-i,+i,0,100),a=this.invertsY_?100-r:r;this.lineElem_.setAttributeNS(null,"x2",o+"%"),this.lineElem_.setAttributeNS(null,"y2",a+"%"),this.markerElem_.setAttributeNS(null,"cx",o+"%"),this.markerElem_.setAttributeNS(null,"cy",a+"%")},t.prototype.onValueChange_=function(){this.update()},t.prototype.onFoldableChange_=function(){this.update()},t}(),ii=function(){function t(t,e){var n=this;this.triggerElement=null,this.onFocusableElementBlur_=this.onFocusableElementBlur_.bind(this),this.onKeyDown_=this.onKeyDown_.bind(this),this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.foldable=new Ue,this.baseSteps_=e.baseSteps,this.maxValue_=e.maxValue,this.invertsY_=e.invertsY,this.view=new ni(t,{foldable:this.foldable,invertsY:this.invertsY_,maxValue:this.maxValue_,value:this.value}),this.ptHandler_=new en(t,this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.allFocusableElements.forEach((function(t){t.addEventListener("blur",n.onFocusableElementBlur_)}))}return t.prototype.handlePointerEvent_=function(t){var e=this.maxValue_,n=Dt(t.px,0,1,-e,+e),i=Dt(this.invertsY_?1-t.py:t.py,0,1,-e,+e);this.value.rawValue=new Zn(n,i),this.view.update()},t.prototype.onPointerDown_=function(t){this.handlePointerEvent_(t.data)},t.prototype.onPointerMove_=function(t){this.handlePointerEvent_(t.data)},t.prototype.onPointerUp_=function(t){this.handlePointerEvent_(t.data)},t.prototype.onPadKeyDown_=function(t){We(t.keyCode)&&t.preventDefault(),this.value.rawValue=new Zn(this.value.rawValue.x+qe(this.baseSteps_[0],Ye(t)),this.value.rawValue.y+qe(this.baseSteps_[1],Ge(t))*(this.invertsY_?1:-1))},t.prototype.onFocusableElementBlur_=function(t){var e=this.view.element,n=D(t);n&&e.contains(n)||n&&n===this.triggerElement&&!P(e.ownerDocument)||(this.foldable.expanded=!1)},t.prototype.onKeyDown_=function(t){27===t.keyCode&&(this.foldable.expanded=!1)},t}(),oi=d("p2dtxt"),ri=function(){function t(t,e){var n=this;this.onValueChange_=this.onValueChange_.bind(this),this.formatters_=e.formatters,this.element=t.createElement("div"),this.element.classList.add(oi());var i=[0,1].map((function(){var e=t.createElement("input");return e.classList.add(oi("i")),e.type="text",e}));[0,1].forEach((function(e,o){var r=t.createElement("div");r.classList.add(oi("w")),r.appendChild(i[o]),n.element.appendChild(r)})),this.inputElems_=[i[0],i[1]],e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update()}return Object.defineProperty(t.prototype,"inputElements",{get:function(){return this.inputElems_},enumerable:!1,configurable:!0}),t.prototype.update=function(){var t=this;this.value.rawValue.getComponents().forEach((function(e,n){t.inputElems_[n].value=t.formatters_[n](e)}))},t.prototype.onValueChange_=function(){this.update()},t}(),ai=function(){function t(t,e){var n=this;this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.parser_=e.parser,this.value=e.value,this.baseSteps_=[e.axes[0].baseStep,e.axes[1].baseStep],this.view=new ri(t,{formatters:[e.axes[0].formatter,e.axes[1].formatter],value:this.value}),this.view.inputElements.forEach((function(t){t.addEventListener("change",n.onInputChange_),t.addEventListener("keydown",n.onInputKeyDown_)}))}return t.prototype.findIndexOfInputElem_=function(t){for(var e=this.view.inputElements,n=0;n<e.length;n++)if(e[n]===t)return n;return null},t.prototype.updateComponent_=function(t,e){var n=this.value.rawValue.getComponents().map((function(n,i){return i===t?e:n}));this.value.rawValue=new Zn(n[0],n[1]),this.view.update()},t.prototype.onInputChange_=function(t){var e=a(t.currentTarget),n=this.parser_(e.value);if(!s(n)){var i=this.findIndexOfInputElem_(e);s(i)||this.updateComponent_(i,n)}},t.prototype.onInputKeyDown_=function(t){var e=a(t.currentTarget),n=this.parser_(e.value);if(!s(n)){var i=this.findIndexOfInputElem_(e);if(!s(i)){var o=qe(this.baseSteps_[i],Ge(t));0!==o&&this.updateComponent_(i,n+o)}}},t}(),si=function(){function t(t,e){this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=e.value,this.padIc_=new ii(t,{baseSteps:[e.axes[0].baseStep,e.axes[1].baseStep],invertsY:e.invertsY,maxValue:e.maxValue,value:this.value}),this.textIc_=new ai(t,{axes:e.axes,parser:e.parser,value:this.value}),this.view=new ti(t,{padView:this.padIc_.view,textView:this.textIc_.view}),this.view.padButtonElement.addEventListener("blur",this.onPadButtonBlur_),this.view.padButtonElement.addEventListener("click",this.onPadButtonClick_),this.padIc_.triggerElement=this.view.padButtonElement}return t.prototype.onPadButtonBlur_=function(t){var e=this.view.element,n=a(t.relatedTarget);n&&e.contains(n)||(this.padIc_.foldable.expanded=!1)},t.prototype.onPadButtonClick_=function(){this.padIc_.foldable.expanded=!this.padIc_.foldable.expanded,this.padIc_.foldable.expanded&&this.padIc_.view.allFocusableElements[0].focus()},t}();function li(t){return Zn.isObject(t)?new Zn(t.x,t.y):new Zn}function hi(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y)}function ui(t){if(t){var e=[];return s(t.step)||e.push(new Tt({step:t.step})),s(t.max)&&s(t.min)||e.push(new Nn({max:t.max,min:t.min})),new Pt({constraints:e})}}function di(t){return new Qn({x:ui("x"in t?t.x:void 0),y:ui("y"in t?t.y:void 0)})}function pi(t,e){var n=t&&It(t,Nn);if(n)return Math.max(Math.abs(n.minValue||0),Math.abs(n.maxValue||0));var i=qt(t);return Math.max(10*Math.abs(i),10*Math.abs(e))}function ci(t,e){var n=e instanceof Qn?e.x:void 0,i=e instanceof Qn?e.y:void 0,o=pi(n,t.x),r=pi(i,t.y);return Math.max(o,r)}function fi(t,e,n){var i=e.constraint;if(!(i instanceof Qn))throw nt.shouldNeverHappen();return new si(t,{axes:[{baseStep:qt(i.x),formatter:de(Kt(i.x,e.rawValue.x))},{baseStep:qt(i.y),formatter:de(Kt(i.y,e.rawValue.y))}],invertsY:n,maxValue:ci(e.rawValue,e.constraint),parser:le,value:e})}function vi(t){if(!("y"in t))return!1;var e=t.y;return!!e&&"inverted"in e&&!!e.inverted}var mi={id:"input-point2d",binding:{accept:function(t,e){return Zn.isObject(t)?t:null},reader:function(t){return li},writer:function(t){return hi},constraint:function(t){return di(t.params)},equals:Zn.equals},controller:function(t){return fi(t.document,t.binding.value,vi(t.params))}},gi=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.z=n}return t.prototype.getComponents=function(){return[this.x,this.y,this.z]},t.isObject=function(t){if(s(t))return!1;var e=t.x,n=t.y,i=t.z;return"number"==typeof e&&"number"==typeof n&&"number"==typeof i},t.equals=function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z},t.prototype.toObject=function(){return{x:this.x,y:this.y,z:this.z}},t}(),bi=function(){function t(t){this.x=t.x,this.y=t.y,this.z=t.z}return t.prototype.constrain=function(t){return new gi(this.x?this.x.constrain(t.x):t.x,this.y?this.y.constrain(t.y):t.y,this.z?this.z.constrain(t.z):t.z)},t}(),_i=d("p3dtxt"),xi=function(){function t(t,e){var n=this;this.onValueChange_=this.onValueChange_.bind(this),this.formatters_=e.formatters,this.element=t.createElement("div"),this.element.classList.add(_i());var i=[0,1,2].map((function(){var e=t.createElement("input");return e.classList.add(_i("i")),e.type="text",e}));[0,1,2].forEach((function(e,o){var r=t.createElement("div");r.classList.add(_i("w")),r.appendChild(i[o]),n.element.appendChild(r)})),this.inputElems_=[i[0],i[1],i[2]],e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update()}return Object.defineProperty(t.prototype,"inputElements",{get:function(){return this.inputElems_},enumerable:!1,configurable:!0}),t.prototype.update=function(){var t=this;this.value.rawValue.getComponents().forEach((function(e,n){t.inputElems_[n].value=t.formatters_[n](e)}))},t.prototype.onValueChange_=function(){this.update()},t}(),yi=function(){function t(t,e){var n=this;this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.parser_=e.parser,this.value=e.value;var i=e.axes;this.baseSteps_=[i[0].baseStep,i[1].baseStep,i[2].baseStep],this.view=new xi(t,{formatters:[i[0].formatter,i[1].formatter,i[2].formatter],value:this.value}),this.view.inputElements.forEach((function(t){t.addEventListener("change",n.onInputChange_),t.addEventListener("keydown",n.onInputKeyDown_)}))}return t.prototype.findIndexOfInputElem_=function(t){for(var e=this.view.inputElements,n=0;n<e.length;n++)if(e[n]===t)return n;return null},t.prototype.updateComponent_=function(t,e){var n=this.value.rawValue.getComponents().map((function(n,i){return i===t?e:n}));this.value.rawValue=new gi(n[0],n[1],n[2]),this.view.update()},t.prototype.onInputChange_=function(t){var e=a(t.currentTarget),n=this.parser_(e.value);if(!s(n)){var i=this.findIndexOfInputElem_(e);s(i)||this.updateComponent_(i,n)}},t.prototype.onInputKeyDown_=function(t){var e=a(t.currentTarget),n=this.parser_(e.value);if(!s(n)){var i=this.findIndexOfInputElem_(e);if(!s(i)){var o=qe(this.baseSteps_[i],Ge(t));0!==o&&this.updateComponent_(i,n+o)}}},t}();function wi(t){return gi.isObject(t)?new gi(t.x,t.y,t.z):new gi}function Ei(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}function Ci(t){if(t){var e=[];return s(t.step)||e.push(new Tt({step:t.step})),s(t.max)&&s(t.min)||e.push(new Nn({max:t.max,min:t.min})),new Pt({constraints:e})}}function ki(t){return new bi({x:Ci("x"in t?t.x:void 0),y:Ci("y"in t?t.y:void 0),z:Ci("z"in t?t.z:void 0)})}function Li(t,e){return{baseStep:qt(e),formatter:de(Kt(e,t))}}function Vi(t,e){var n=e.constraint;if(!(n instanceof bi))throw nt.shouldNeverHappen();return new yi(t,{axes:[Li(e.rawValue.x,n.x),Li(e.rawValue.y,n.y),Li(e.rawValue.z,n.z)],parser:le,value:e})}var Mi={id:"input-point3d",binding:{accept:function(t,e){return gi.isObject(t)?t:null},reader:function(t){return wi},writer:function(t){return Ei},constraint:function(t){return ki(t.params)},equals:gi.equals},controller:function(t){return Vi(t.document,t.binding.value)}};function Ai(t){return String(t)}function Pi(t){return t}function Ii(t){var e=[];return"options"in t&&void 0!==t.options&&e.push(new St({options:jt(t.options,Ai)})),new Pt({constraints:e})}function Si(t,e){var n,i=e.constraint;return i&&It(i,St)?new Xt(t,{listItems:null!==(n=Ht(i))&&void 0!==n?n:[],stringifyValue:function(t){return t},value:e}):new oe(t,{formatter:Pi,parser:function(t){return t},value:e})}var Fi={id:"input-string",binding:{accept:function(t,e){return"string"==typeof t?t:null},constraint:function(t){return Ii(t.params)},reader:function(t){return Ai},writer:function(t){return Ot}},controller:function(t){return Si(t.document,t.binding.value)}},Ri=d("mll"),Bi=function(){function t(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Ri());var n=t.createElement("textarea");n.classList.add(Ri("i")),n.style.height="calc(var(--unit-size) * "+e.lineCount+")",n.readOnly=!0,this.element.appendChild(n),this.textareaElem_=n,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update()}return t.prototype.update=function(){var t=this,e=this.textareaElem_,n=e.scrollTop===e.scrollHeight-e.clientHeight;e.textContent=this.value.rawValue.map((function(e){return void 0!==e?t.formatter_(e):""})).join("\n"),n&&(e.scrollTop=e.scrollHeight)},t.prototype.onValueUpdate_=function(){this.update()},t}(),Oi=function(){function t(t,e){this.value=e.value,this.view=new Bi(t,{formatter:e.formatter,lineCount:e.lineCount,value:this.value})}return t}(),Ti=d("sgl"),Di=function(){function t(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Ti());var n=t.createElement("input");n.classList.add(Ti("i")),n.readOnly=!0,n.type="text",this.element.appendChild(n),this.inputElem_=n,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update()}return t.prototype.update=function(){var t=this.value.rawValue,e=t[t.length-1];this.inputElem_.value=void 0!==e?this.formatter_(e):""},t.prototype.onValueUpdate_=function(){this.update()},t}(),Ni=function(){function t(t,e){this.value=e.value,this.view=new Di(t,{formatter:e.formatter,value:this.value})}return t}(),$i={id:"monitor-bool",binding:{accept:function(t,e){return"boolean"==typeof t?t:null},reader:function(t){return Rt}},controller:function(t){var e;return 1===t.binding.value.rawValue.length?new Ni(t.document,{formatter:Bt,value:t.binding.value}):new Oi(t.document,{formatter:Bt,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:lt.monitor.defaultLineCount,value:t.binding.value})}},zi=function(){function t(){this.emitter=new v,this.index_=-1}return Object.defineProperty(t.prototype,"index",{get:function(){return this.index_},set:function(t){this.index_!==t&&(this.index_=t,this.emitter.emit("change",{index:t,sender:this}))},enumerable:!1,configurable:!0}),t}(),ji=d("grl"),Hi=function(){function t(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(ji()),this.formatter_=e.formatter,this.minValue_=e.minValue,this.maxValue_=e.maxValue,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);var n=t.createElementNS(V,"svg");n.classList.add(ji("g")),n.style.height="calc(var(--unit-size) * "+e.lineCount+")",this.element.appendChild(n),this.svgElem_=n;var i=t.createElementNS(V,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;var o=t.createElement("div");o.classList.add(ji("t")),this.element.appendChild(o),this.tooltipElem_=o,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update()}return Object.defineProperty(t.prototype,"graphElement",{get:function(){return this.svgElem_},enumerable:!1,configurable:!0}),t.prototype.update=function(){var t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,n=this.minValue_,i=this.maxValue_,o=[];this.value.rawValue.forEach((function(r,a){if(void 0!==r){var s=Dt(a,0,e,0,t.width),l=Dt(r,n,i,t.height,0);o.push([s,l].join(","))}})),this.lineElem_.setAttributeNS(null,"points",o.join(" "));var r=this.tooltipElem_,a=this.value.rawValue[this.cursor_.index];if(void 0!==a){r.classList.add(ji("t","valid"));var s=Dt(this.cursor_.index,0,e,0,t.width),l=Dt(a,n,i,t.height,0);r.style.left=s+"px",r.style.top=l+"px",r.textContent=""+this.formatter_(a)}else r.classList.remove(ji("t","valid"))},t.prototype.onValueUpdate_=function(){this.update()},t.prototype.onCursorChange_=function(){this.update()},t}(),Ui=function(){function t(t,e){this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.value=e.value,this.cursor_=new zi,this.view=new Hi(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,maxValue:e.maxValue,minValue:e.minValue,value:this.value}),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_),this.view.element.addEventListener("mousemove",this.onGraphMouseMove_)}return t.prototype.onGraphMouseLeave_=function(){this.cursor_.index=-1},t.prototype.onGraphMouseMove_=function(t){var e=this.view.graphElement.getBoundingClientRect(),n=t.offsetX;this.cursor_.index=Math.floor(Dt(n,0,e.width,0,this.value.rawValue.length))},t}();function Ki(){return de(2)}function qi(t,e,n){var i;return 1===e.value.rawValue.length?new Ni(t,{formatter:Ki(),value:e.value}):new Oi(t,{formatter:Ki(),lineCount:null!==(i=n.lineCount)&&void 0!==i?i:lt.monitor.defaultLineCount,value:e.value})}function Gi(t){var e,n,i,o=t.document,r=t.binding,a=t.params;return new Ui(o,{formatter:Ki(),lineCount:null!==(e=a.lineCount)&&void 0!==e?e:lt.monitor.defaultLineCount,maxValue:null!==(n="max"in a?a.max:null)&&void 0!==n?n:100,minValue:null!==(i="min"in a?a.min:null)&&void 0!==i?i:0,value:r.value})}function Yi(t){return"view"in t&&"graph"===t.view}var Xi={id:"monitor-number",binding:{accept:function(t,e){return"number"==typeof t?t:null},defaultBufferSize:function(t){return Yi(t)?64:1},reader:function(t){return he}},controller:function(t){return Yi(t.params)?Gi({document:t.document,binding:t.binding,params:t.params}):qi(t.document,t.binding,t.params)}},Wi={id:"monitor-string",binding:{accept:function(t,e){return"string"==typeof t?t:null},reader:function(t){return Ai}},controller:function(t){var e,n=t.binding.value;return n.rawValue.length>1||"multiline"in t.params&&t.params.multiline?new Oi(t.document,{formatter:Pi,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:lt.monitor.defaultLineCount,value:n}):new Ni(t.document,{formatter:Pi,value:n})}};function Zi(t){var e=t.createElement("div");return e.classList.add(d("dfw")()),t.body&&t.body.appendChild(e),e}function Qi(t,e,n){if(!t.querySelector("style[data-tp-style="+e+"]")){var i=t.createElement("style");i.dataset.tpStyle=e,i.textContent=n,t.head.appendChild(i)}}function Ji(t){Qi(t,"default",".tp-btnv_b,.tp-lstv_s,.tp-p2dpadtxtv_b,.tp-fldv_t,.tp-rotv_t,.tp-cctxtsv_i,.tp-cswv_sw,.tp-p2dpadv_p,.tp-p2dtxtv_i,.tp-p3dtxtv_i,.tp-txtv_i,.tp-grlv_g,.tp-sglv_i,.tp-mllv_i,.tp-ckbv_i,.tp-cctxtsv_ms{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-btnv_b,.tp-lstv_s,.tp-p2dpadtxtv_b{background-color:var(--button-background-color);border-radius:2px;color:var(--button-foreground-color);cursor:pointer;display:block;font-weight:bold;height:var(--unit-size);line-height:var(--unit-size);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-btnv_b:hover,.tp-lstv_s:hover,.tp-p2dpadtxtv_b:hover{background-color:var(--button-background-color-hover)}.tp-btnv_b:focus,.tp-lstv_s:focus,.tp-p2dpadtxtv_b:focus{background-color:var(--button-background-color-focus)}.tp-btnv_b:active,.tp-lstv_s:active,.tp-p2dpadtxtv_b:active{background-color:var(--button-background-color-active)}.tp-fldv_t,.tp-rotv_t{background-color:var(--folder-background-color);color:var(--folder-foreground-color);cursor:pointer;display:block;height:calc(var(--unit-size) + 4px);line-height:calc(var(--unit-size) + 4px);overflow:hidden;padding-left:28px;position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-fldv_t:hover,.tp-rotv_t:hover{background-color:var(--folder-background-color-hover)}.tp-fldv_t:focus,.tp-rotv_t:focus{background-color:var(--folder-background-color-focus)}.tp-fldv_t:active,.tp-rotv_t:active{background-color:var(--folder-background-color-active)}.tp-fldv_m,.tp-rotv_m{background:linear-gradient(to left, var(--folder-foreground-color), var(--folder-foreground-color) 2px, transparent 2px, transparent 4px, var(--folder-foreground-color) 4px);border-radius:2px;bottom:0;content:'';display:block;height:6px;left:13px;margin:auto;opacity:0.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-fldv.tp-fldv-expanded>.tp-fldv_t>.tp-fldv_m,.tp-rotv.tp-rotv-expanded .tp-rotv_m{transform:none}.tp-fldv_c,.tp-rotv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-fldv_c>.tp-fldv.tp-v-first,.tp-rotv_c>.tp-fldv.tp-v-first{margin-top:-4px}.tp-fldv_c>.tp-fldv.tp-v-last,.tp-rotv_c>.tp-fldv.tp-v-last{margin-bottom:-4px}.tp-fldv_c>*:not(.tp-v-first),.tp-rotv_c>*:not(.tp-v-first){margin-top:4px}.tp-fldv_c>.tp-fldv:not(.tp-v-hidden)+.tp-fldv,.tp-rotv_c>.tp-fldv:not(.tp-v-hidden)+.tp-fldv{margin-top:0}.tp-fldv_c>.tp-sptv:not(.tp-v-hidden)+.tp-sptv,.tp-rotv_c>.tp-sptv:not(.tp-v-hidden)+.tp-sptv{margin-top:0}.tp-fldv.tp-fldv-expanded>.tp-fldv_c,.tp-rotv.tp-rotv-expanded .tp-rotv_c{opacity:1;padding-bottom:4px;padding-top:4px;transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-cctxtsv_i,.tp-cswv_sw,.tp-p2dpadv_p,.tp-p2dtxtv_i,.tp-p3dtxtv_i,.tp-txtv_i{background-color:var(--input-background-color);border-radius:2px;box-sizing:border-box;color:var(--input-foreground-color);font-family:inherit;height:var(--unit-size);line-height:var(--unit-size);min-width:0;width:100%}.tp-cctxtsv_i:hover,.tp-cswv_sw:hover,.tp-p2dpadv_p:hover,.tp-p2dtxtv_i:hover,.tp-p3dtxtv_i:hover,.tp-txtv_i:hover{background-color:var(--input-background-color-hover)}.tp-cctxtsv_i:focus,.tp-cswv_sw:focus,.tp-p2dpadv_p:focus,.tp-p2dtxtv_i:focus,.tp-p3dtxtv_i:focus,.tp-txtv_i:focus{background-color:var(--input-background-color-focus)}.tp-cctxtsv_i:active,.tp-cswv_sw:active,.tp-p2dpadv_p:active,.tp-p2dtxtv_i:active,.tp-p3dtxtv_i:active,.tp-txtv_i:active{background-color:var(--input-background-color-active)}.tp-grlv_g,.tp-sglv_i,.tp-mllv_i{background-color:var(--monitor-background-color);border-radius:2px;box-sizing:border-box;color:var(--monitor-foreground-color);height:var(--unit-size);width:100%}.tp-btnv{padding:0 4px}.tp-btnv_b{width:100%}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_m{background-color:var(--input-background-color);border-radius:2px;cursor:pointer;display:block;height:var(--unit-size);position:relative;width:var(--unit-size)}.tp-ckbv_m::before{background-color:var(--input-foreground-color);border-radius:2px;bottom:4px;content:'';display:block;left:4px;opacity:0;position:absolute;right:4px;top:4px}.tp-ckbv_i:hover+.tp-ckbv_m{background-color:var(--input-background-color-hover)}.tp-ckbv_i:focus+.tp-ckbv_m{background-color:var(--input-background-color-focus)}.tp-ckbv_i:active+.tp-ckbv_m{background-color:var(--input-background-color-active)}.tp-ckbv_i:checked+.tp-ckbv_m::before{opacity:1}.tp-cctxtsv{display:flex;width:100%}.tp-cctxtsv_m{margin-right:4px;position:relative}.tp-cctxtsv_ms{border-radius:2px;color:var(--label-foreground-color);cursor:pointer;height:var(--unit-size);line-height:var(--unit-size);padding:0 18px 0 4px}.tp-cctxtsv_ms:hover{background-color:var(--input-background-color-hover)}.tp-cctxtsv_ms:focus{background-color:var(--input-background-color-focus)}.tp-cctxtsv_ms:active{background-color:var(--input-background-color-active)}.tp-cctxtsv_mm{border-color:var(--label-foreground-color) transparent transparent;border-style:solid;border-width:3px;box-sizing:border-box;height:6px;pointer-events:none;width:6px;bottom:0;margin:auto;position:absolute;right:6px;top:3px}.tp-cctxtsv_w{display:flex;flex:1}.tp-cctxtsv_i{border-radius:0;flex:1;padding:0 4px}.tp-cctxtsv_i:first-child{border-bottom-left-radius:2px;border-top-left-radius:2px}.tp-cctxtsv_i:last-child{border-bottom-right-radius:2px;border-top-right-radius:2px}.tp-cctxtsv_i+.tp-cctxtsv_i{margin-left:2px}.tp-clpv{background-color:var(--base-background-color);border-radius:6px;box-shadow:0 2px 4px var(--base-shadow-color);display:none;padding:4px;position:relative;visibility:hidden;z-index:1000}.tp-clpv.tp-clpv-expanded{display:block;visibility:visible}.tp-clpv_h,.tp-clpv_ap{margin-left:6px;margin-right:6px}.tp-clpv_h{margin-top:4px}.tp-clpv_rgb{display:flex;margin-top:4px;width:100%}.tp-clpv_a{display:flex;margin-top:4px;padding-top:8px;position:relative}.tp-clpv_a:before{background-color:var(--separator-color);content:'';height:4px;left:-4px;position:absolute;right:-4px;top:0}.tp-clpv_ap{align-items:center;display:flex;flex:3}.tp-clpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:2px;outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:80px;width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,0.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0,0,0,0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--unit-size);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:2px;border:rgba(255,255,255,0.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,0.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--unit-size);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:2px;box-shadow:0 0 2px rgba(0,0,0,0.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:2px;border:rgba(255,255,255,0.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-cswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:2px}.tp-cswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--unit-size);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--unit-size)}.tp-cswv_b:focus::after{border:rgba(255,255,255,0.75) solid 2px;border-radius:2px;bottom:0;content:'';display:block;left:0;position:absolute;right:0;top:0}.tp-cswv_p{left:-4px;position:absolute;right:-4px;top:var(--unit-size)}.tp-cswtxtv{display:flex;position:relative}.tp-cswtxtv_s{flex-grow:0;flex-shrink:0;width:var(--unit-size)}.tp-cswtxtv_t{flex:1;margin-left:4px}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-expanded .tp-fldv_t{transition:border-radius 0s}.tp-fldv_c{border-left:var(--folder-background-color) solid 4px}.tp-fldv_t:hover+.tp-fldv_c{border-left-color:var(--folder-background-color-hover)}.tp-fldv_t:focus+.tp-fldv_c{border-left-color:var(--folder-background-color-focus)}.tp-fldv_t:active+.tp-fldv_c{border-left-color:var(--folder-background-color-active)}.tp-fldv_c>.tp-fldv{margin-left:4px}.tp-fldv_c>.tp-fldv>.tp-fldv_t{border-top-left-radius:2px;border-bottom-left-radius:2px}.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_t{border-bottom-left-radius:0}.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:2px}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--unit-size) * 3)}.tp-grlv_g polyline{fill:none;stroke:var(--monitor-foreground-color);stroke-linejoin:round}.tp-grlv_t{color:var(--monitor-foreground-color);font-size:0.9em;left:0;pointer-events:none;position:absolute;text-indent:4px;top:0;visibility:hidden}.tp-grlv_t.tp-grlv_t-valid{visibility:visible}.tp-grlv_t::before{background-color:var(--monitor-foreground-color);border-radius:100%;content:'';display:block;height:4px;left:-2px;position:absolute;top:-2px;width:4px}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:4px;padding-right:4px}.tp-lblv_l{color:var(--label-foreground-color);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lstv{position:relative}.tp-lstv_s{padding:0 18px 0 4px;width:100%}.tp-lstv_m{border-color:var(--button-foreground-color) transparent transparent;border-style:solid;border-width:3px;box-sizing:border-box;height:6px;pointer-events:none;width:6px;bottom:0;margin:auto;position:absolute;right:6px;top:3px}.tp-sglv_i{padding:0 4px}.tp-mllv_i{display:block;height:calc(var(--unit-size) * 3);line-height:var(--unit-size);padding:0 4px;resize:none;white-space:pre}.tp-p2dpadv{background-color:var(--base-background-color);border-radius:6px;box-shadow:0 2px 4px var(--base-shadow-color);display:none;padding:4px 4px 4px calc(4px * 2 + var(--unit-size));position:relative;visibility:hidden;z-index:1000}.tp-p2dpadv.tp-p2dpadv-expanded{display:block;visibility:visible}.tp-p2dpadv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpadv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpadv_ax{stroke:var(--input-guide-color)}.tp-p2dpadv_l{stroke:var(--input-foreground-color);stroke-linecap:round;stroke-dasharray:1px 3px}.tp-p2dpadv_m{fill:var(--input-foreground-color)}.tp-p2dpadtxtv{display:flex;position:relative}.tp-p2dpadtxtv_b{height:var(--unit-size);position:relative;width:var(--unit-size)}.tp-p2dpadtxtv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dpadtxtv_p{left:-4px;position:absolute;right:-4px;top:var(--unit-size)}.tp-p2dpadtxtv_t{margin-left:4px}.tp-p2dtxtv{display:flex}.tp-p2dtxtv_w{align-items:center;display:flex}.tp-p2dtxtv_w+.tp-p2dtxtv_w{margin-left:2px}.tp-p2dtxtv_i{padding:0 4px;width:100%}.tp-p2dtxtv_w:nth-child(1) .tp-p2dtxtv_i{border-top-right-radius:0;border-bottom-right-radius:0}.tp-p2dtxtv_w:nth-child(2) .tp-p2dtxtv_i{border-top-left-radius:0;border-bottom-left-radius:0}.tp-p3dtxtv{display:flex}.tp-p3dtxtv_w{align-items:center;display:flex}.tp-p3dtxtv_w+.tp-p3dtxtv_w{margin-left:2px}.tp-p3dtxtv_i{padding:0 4px;width:100%}.tp-p3dtxtv_w:first-child .tp-p3dtxtv_i{border-top-right-radius:0;border-bottom-right-radius:0}.tp-p3dtxtv_w:not(:first-child):not(:last-child) .tp-p3dtxtv_i{border-radius:0}.tp-p3dtxtv_w:last-child .tp-p3dtxtv_i{border-top-left-radius:0;border-bottom-left-radius:0}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono,Source Code Pro,Menlo,Courier,monospace);--unit-size: var(--tp-unit-size, 20px);--base-background-color: var(--tp-base-background-color, #2f3137);--base-shadow-color: var(--tp-base-shadow-color, rgba(0,0,0,0.2));--button-background-color: var(--tp-button-background-color, #adafb8);--button-background-color-active: var(--tp-button-background-color-active, #d6d7db);--button-background-color-focus: var(--tp-button-background-color-focus, #c8cad0);--button-background-color-hover: var(--tp-button-background-color-hover, #bbbcc4);--button-foreground-color: var(--tp-button-foreground-color, #2f3137);--folder-background-color: var(--tp-folder-background-color, rgba(200,202,208,0.1));--folder-background-color-active: var(--tp-folder-background-color-active, rgba(200,202,208,0.25));--folder-background-color-focus: var(--tp-folder-background-color-focus, rgba(200,202,208,0.2));--folder-background-color-hover: var(--tp-folder-background-color-hover, rgba(200,202,208,0.15));--folder-foreground-color: var(--tp-folder-foreground-color, #c8cad0);--input-background-color: var(--tp-input-background-color, rgba(200,202,208,0.1));--input-background-color-active: var(--tp-input-background-color-active, rgba(200,202,208,0.25));--input-background-color-focus: var(--tp-input-background-color-focus, rgba(200,202,208,0.2));--input-background-color-hover: var(--tp-input-background-color-hover, rgba(200,202,208,0.15));--input-foreground-color: var(--tp-input-foreground-color, #c8cad0);--input-guide-color: var(--tp-input-guide-color, rgba(47,49,55,0.5));--label-foreground-color: var(--tp-label-foreground-color, rgba(200,202,208,0.7));--monitor-background-color: var(--tp-monitor-background-color, #26272c);--monitor-foreground-color: var(--tp-monitor-foreground-color, rgba(200,202,208,0.7));--separator-color: var(--tp-separator-color, #26272c)}.tp-rotv{background-color:var(--base-background-color);border-radius:6px;box-shadow:0 2px 4px var(--base-shadow-color);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_t{border-bottom-left-radius:6px;border-bottom-right-radius:6px;border-top-left-radius:6px;border-top-right-radius:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_t{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv_m{transition:none}.tp-rotv_c>.tp-fldv:last-child>.tp-fldv_c{border-bottom-left-radius:6px;border-bottom-right-radius:6px}.tp-rotv_c>.tp-fldv:last-child:not(.tp-fldv-expanded)>.tp-fldv_t{border-bottom-left-radius:6px;border-bottom-right-radius:6px}.tp-rotv_c>.tp-fldv:first-child>.tp-fldv_t{border-top-left-radius:6px;border-top-right-radius:6px}.tp-sptv_r{background-color:var(--separator-color);border-width:0;display:block;height:4px;margin:0;width:100%}.tp-sldv_o{box-sizing:border-box;cursor:pointer;height:var(--unit-size);margin:0 6px;outline:none;position:relative}.tp-sldv_o::before{background-color:var(--input-background-color);border-radius:1px;bottom:0;content:'';display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_i{height:100%;left:0;position:absolute;top:0}.tp-sldv_i::before{background-color:var(--button-background-color);border-radius:2px;bottom:0;content:'';display:block;height:12px;margin:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_o:hover .tp-sldv_i::before{background-color:var(--button-background-color-hover)}.tp-sldv_o:focus .tp-sldv_i::before{background-color:var(--button-background-color-focus)}.tp-sldv_o:active .tp-sldv_i::before{background-color:var(--button-background-color-active)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-txtv_i{padding:0 4px}.tp-v-hidden{display:none}"),r().forEach((function(e){e.css&&Qi(t,"plugin-"+e.id,e.css)}))}var to=function(t){function n(e){var n,i=this,o=e||{},r=null!==(n=o.document)&&void 0!==n?n:S(),a=new At(r,{expanded:o.expanded,blade:new L,title:o.title});return(i=t.call(this,a)||this).containerElem_=o.container||Zi(r),i.containerElem_.appendChild(i.element),i.doc_=r,i.usesDefaultWrapper_=!o.container,Ji(i.document),i}return e(n,t),Object.defineProperty(n.prototype,"document",{get:function(){if(!this.doc_)throw nt.alreadyDisposed();return this.doc_},enumerable:!1,configurable:!0}),n.prototype.dispose=function(){var e=this.containerElem_;if(!e)throw nt.alreadyDisposed();if(this.usesDefaultWrapper_){var n=e.parentElement;n&&n.removeChild(e)}this.containerElem_=null,this.doc_=null,t.prototype.dispose.call(this)},n}(kt);function eo(){[mi,Mi,Fi,Wn,Dn,Tn,Bn,ee].forEach((function(t){kt.registerPlugin({type:"input",plugin:t})})),[$i,Wi,Xi].forEach((function(t){kt.registerPlugin({type:"monitor",plugin:t})}))}return eo(),to}();var Lt=kt.exports;const Vt=(t,e)=>{const n=new Lt({container:e});if("cullFace"in t&&n.addInput({cullFace:t.cullFace},"cullFace").on("change",(e=>{t.cullFace=e})),"depthTest"in t&&n.addInput({depthTest:t.depthTest},"depthTest").on("change",(e=>{t.depthTest=e})),t.view){const e=n.addFolder({title:"view",expanded:!0});e.addInput({fovy:t.view.fovy},"fovy",{step:.1}).on("change",(e=>{t.view.fovy=e})),e.addInput({near:t.view.near},"near",{step:.1}).on("change",(e=>{t.view.near=e})),e.addInput({far:t.view.far},"far",{step:.1}).on("change",(e=>{t.view.far=e}))}if(t.light){n.addFolder({title:"light",expanded:!0}).addInput({position:t.light.position},"position",{x:{step:.1},y:{step:.1},z:{step:.1}}).on("change",(e=>{t.light.position=e}))}if(t.diffuseLight){n.addFolder({title:"diffuseLight",expanded:!0}).addInput({enable:t.diffuseLight.enable},"enable").on("change",(e=>{t.diffuseLight.enable=e}))}if(t.ambientLight){const e=n.addFolder({title:"ambientLight",expanded:!0});e.addInput({enable:t.ambientLight.enable},"enable").on("change",(e=>{t.ambientLight.enable=e})),e.addInput({intensity:t.ambientLight.intensity},"intensity",{step:.1}).on("change",(e=>{t.ambientLight.intensity=e}))}if(t.specularLight){const e=n.addFolder({title:"specularLight",expanded:!0});e.addInput({enable:t.specularLight.enable},"enable").on("change",(e=>{t.specularLight.enable=e})),e.addInput({shininess:t.specularLight.shininess},"shininess",{step:.1}).on("change",(e=>{t.specularLight.shininess=e}))}};class Mt{constructor(){this.program=null,this.pMatrix=G(),this.vMatrix=G(),this.vpMatrix=G(),this.attLocation=[],this.attStride=[],this.uniLocation=Ct,this.parameters={cullFace:!1,depthTest:!1,view:{fovy:45,near:0,far:20}},this.targetPosition=[0,3,0],this.taxis=new U}init(t,e){this.canvas=t,this.gl=t.getContext("webgl"),this.camera=new gt(t,{position:{direction:[0,1,1],distance:10}}),Vt(this.parameters,e),this.addResizeEvent(),this.setupProgram(),this.setupBoxGeometry(),this.setupAxisGeometry(),this.setupLocation(),this.render()}destroy(){this.taxis.reset()}setupProgram(){const t=ct(this.gl,yt,this.gl.VERTEX_SHADER),e=ct(this.gl,xt,this.gl.FRAGMENT_SHADER);this.program=pt(this.gl,t,e),this.gl.useProgram(this.program)}addResizeEvent(){this.resizeCanvas(),window.addEventListener("resize",this.resizeCanvas,{passive:!0})}resizeCanvas(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}setupLocation(){wt.forEach(((t,e)=>{this.attLocation[e]=this.gl.getAttribLocation(this.program,t.variable),this.attStride[e]=t.attStride})),Object.keys(this.uniLocation).forEach((t=>{this.uniLocation[t]=this.gl.getUniformLocation(this.program,t)}))}setupRendering(t){this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.clearColor(.1,.12,.14,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.reflectParameters(),X(this.vMatrix,this.camera.update()),J(this.pMatrix,this.parameters.view.fovy,this.canvas.width/this.canvas.height,this.parameters.view.near,this.parameters.view.far),W(this.vpMatrix,this.pMatrix,this.vMatrix)}setupBoxGeometry(){this.box=((t,e,n,i)=>{let o=.5*t,r=.5*e,a=.5*n,s=new Float32Array([-o,-r,a,o,-r,a,o,-r,a,o,r,a,o,r,a,-o,r,a,-o,r,a,-o,-r,a,-o,-r,-a,-o,r,-a,-o,r,-a,o,r,-a,o,r,-a,o,-r,-a,o,-r,-a,-o,-r,-a,-o,r,-a,-o,r,a,-o,r,a,o,r,a,o,r,a,o,r,-a,o,r,-a,-o,r,-a,-o,-r,-a,o,-r,-a,o,-r,-a,o,-r,a,o,-r,a,-o,-r,a,-o,-r,a,-o,-r,-a,o,-r,-a,o,r,-a,o,r,-a,o,r,a,o,r,a,o,-r,a,o,-r,a,o,-r,-a,-o,-r,-a,-o,-r,a,-o,-r,a,-o,r,a,-o,r,a,-o,r,-a]);const l=[];for(let t=0;t<s.length/3;t++)l.push(i[0],i[1],i[2],i[3]);return{position:s,color:new Float32Array(l)}})(.5,.5,.5,[1,.45,.45,1]),this.boxVBO=[ft(this.gl,this.box.position),ft(this.gl,this.box.color)]}renderTargetBoxGeometry(t,e){mt(this.gl,this.boxVBO,this.attLocation,this.attStride);const n=5*Math.cos(e/1e3),i=5*Math.sin(e/1e3);this.targetPosition[0]=n,this.targetPosition[2]=i;let o=G();Z(o,o,this.targetPosition),this.setupMvp(o),this.gl.drawArrays(this.gl.LINES,0,this.box.position.length/3)}renderBoxGeometry(t){mt(this.gl,this.boxVBO,this.attLocation,this.attStride);let e=G();Z(e,e,t),tt(e,t,this.targetPosition,[0,1,0]),this.setupMvp(e),this.gl.drawArrays(this.gl.LINES,0,this.box.position.length/3)}setupAxisGeometry(){this.axis=ut(20),this.axisVBO=[ft(this.gl,this.axis.position),ft(this.gl,this.axis.color)]}renderAxis(t){mt(this.gl,this.axisVBO,this.attLocation,this.attStride);let e=G();Z(e,e,t),this.setupMvp(e),this.gl.drawArrays(this.gl.LINES,0,this.axis.position.length/3)}setupMvp(t){const e=G();W(e,this.vpMatrix,t),this.gl.uniformMatrix4fv(this.uniLocation.mvpMatrix,!1,e)}render(){this.taxis.begin(),this.taxis.ticker(((t,e)=>{this.setupRendering(t),this.renderTargetBoxGeometry([0,3,0],t);for(let t=0;t<10;t++)for(let e=0;e<10;e++){const n=1*(e-5)+.5,i=1*(t-5)+.5;this.renderBoxGeometry([n,0,i])}this.renderAxis([0,0,0])}))}reflectParameters(){this.parameters.cullFace?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.parameters.depthTest?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST)}}function At(e){let n,i,o,r;return{c(){n=u("canvas"),i=p(),o=u("div"),r=u("div"),c(n,"class","w-full h-full"),c(o,"class","fixed right-8 top-8")},m(t,a){l(t,n,a),e[2](n),l(t,i,a),l(t,o,a),s(o,r),e[3](r)},p:t,i:t,o:t,d(t){t&&h(n),e[2](null),t&&h(i),t&&h(o),e[3](null)}}}function Pt(t,e,n){let i,o;const r=new Mt;return g((()=>{r.init(i,o)})),b((()=>{r.destroy()})),[i,o,function(t){x[t?"unshift":"push"]((()=>{i=t,n(0,i)}))},function(t){x[t?"unshift":"push"]((()=>{o=t,n(1,o)}))}]}class It extends z{constructor(t){super(),$(this,t,Pt,At,r,{})}}var St="precision mediump float;\n\nuniform vec3 eyePosition;\nuniform vec3 lightDirection;\n\n// ambient light\nuniform float ambient;\n// uniform float ambientMaterial\n// uniform float ambientLight\nuniform bool enableAmbientLight;\n// diffuse light\n// uniform float diffuseMaterial\n// uniform float diffuseLight\n\n// specular light\n// uniform float specularMaterial\n// uniform float specularLight\nuniform bool enableSpecular;\nuniform float shininess;\n\n// Phong reflection model（フォンの反射モデル）\n//   === Ambient Reflection + Diffuse Reflection + Specular Reflection\n// Ambient Reflection（環境光反射）\n// Diffuse Reflection（拡散反射）\n// Specular Reflection（鏡面反射）\n//\n// ambientRefrlction =\n//   ambientMaterial（環境反射係数） *\n//   ambientLight（環境光成分）\n//\n// diffuseRefrlction =\n//   diffuseMaterial（拡散反射係数） *\n//   diffuseLight（拡散光成分） *\n//   0.0 ~ 1.0（入射角による因数）\n//\n// specularRefrlction =\n//   specularMaterial（鏡面反射係数） *\n//   specularLight（鏡面光成分） *\n//   0.0 ~ 1.0（反射ベクトルによる因数）\n\nvarying vec3 vPosition;\nvarying vec4 vColor;\nvarying vec3 vNormal;\n\n// TODO: lightのon/off制御\n// enableDirectionLight\n// uAmbientMaterial\n// uDiffuseMaterial\n// shininess\n\n\nvoid main(){\n    vec3 light = normalize(lightDirection);\n    // 念の為、単位化\n    vec3 normal = normalize(vNormal);\n\n    float diffuse = max(dot(light, normal), 0.0);\n\n    float ambientIntensity = enableAmbientLight ? ambient : 0.0;\n\n    // 拡散光と環境光の成分をグローバルカラーに適用しておく @@@\n    vec3 rgb = vColor.rgb * min(diffuse + ambientIntensity, 1.0);\n\n    // 視線ベクトルは、カメラの位置とワールド空間上の頂点の位置から求める @@@\n    vec3 eye = normalize(vPosition - eyePosition);\n\n    // 視線ベクトルと法線を使って、反射ベクトルを作る @@@\n    vec3 reflectVector = normalize(reflect(eye, normal));\n\n    // 反射ベクトルとライトベクトルの内積で反射光を計算する @@@\n    float specular = max(dot(reflectVector, light), 0.0);\n\n    // スペキュラ成分はべき算を用いて先鋭化する @@@\n    specular = pow(specular, shininess);\n\n    // フラグが経ってない場合無効化する @@@\n    specular = enableSpecular ? specular : 0.0;\n\n    // 反射光の成分は単純に加算して出力する @@@\n    gl_FragColor = vec4(rgb + specular, 1.0);\n}\n\n",Ft="attribute vec3 position;\nattribute vec4 color;\nattribute vec3 normal;\nuniform mat4 mvpMatrix;\nuniform mat4 normalMatrix;\nvarying vec3 vPosition;\nvarying vec4 vColor;\nvarying vec3 vNormal;\n\n\nvoid main(){\n    vPosition = position;\n    vColor = color;\n    vNormal = (normalMatrix * vec4(normal, 0.0)).xyz;\n\n    gl_Position = mvpMatrix * vec4(position, 1.0);\n}\n\n";const{attribute:Rt,uniform:Bt,uniLocation:Ot}=_t({vertex:Ft,fragment:St});class Tt{constructor(){this.program=null,this.pMatrix=G(),this.vMatrix=G(),this.vpMatrix=G(),this.attLocation=[],this.attStride=[],this.uniLocation=Ot,this.parameters={cullFace:!0,depthTest:!0,light:{position:{x:1,y:1,z:1}},ambientLight:{enable:!0,intensity:.2},specularLight:{enable:!0,shininess:2}},this.axis={geometry:null,VBO:[],IBO:[]},this.items=[],this.taxis=new U}init(t,e){this.canvas=t,this.gl=t.getContext("webgl"),this.camera=new gt(t,{position:{direction:[0,1,1],distance:15}}),Vt(this.parameters,e),this.addResizeEvent(),this.setupProgram(),this.setupItemsGeometry(),this.setupAxisGeometry(),this.setupLocation(),this.render()}destroy(){this.taxis.reset()}setupProgram(){const t=ct(this.gl,Ft,this.gl.VERTEX_SHADER),e=ct(this.gl,St,this.gl.FRAGMENT_SHADER);this.program=pt(this.gl,t,e),this.gl.useProgram(this.program)}addResizeEvent(){this.resizeCanvas(),window.addEventListener("resize",this.resizeCanvas,{passive:!0})}resizeCanvas(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}setupLocation(){Rt.forEach(((t,e)=>{this.attLocation[e]=this.gl.getAttribLocation(this.program,t.variable),this.attStride[e]=t.attStride})),Object.keys(this.uniLocation).forEach((t=>{this.uniLocation[t]=this.gl.getUniformLocation(this.program,t)}))}setupRendering(){this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.clearColor(.1,.12,.14,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.reflectParameters(),this.gl.uniform3fv(this.uniLocation.eyePosition,this.camera.position),this.gl.uniform3fv(this.uniLocation.lightDirection,[this.parameters.light.position.x,this.parameters.light.position.y,this.parameters.light.position.z]),this.gl.uniform1f(this.uniLocation.ambient,this.parameters.ambientLight.intensity),this.gl.uniform1i(this.uniLocation.enableSpecular,Number(this.parameters.specularLight.enable)),this.gl.uniform1f(this.uniLocation.shininess,this.parameters.specularLight.shininess),this.gl.uniform1i(this.uniLocation.enableAmbientLight,Number(this.parameters.ambientLight.enable)),X(this.vMatrix,this.camera.update()),J(this.pMatrix,45,this.canvas.width/this.canvas.height,.1,20),W(this.vpMatrix,this.pMatrix,this.vMatrix)}setupItemsGeometry(){for(let t=0;t<20;t++){const e=Math.random(),n=Math.random(),i=Math.random(),o=[10*Math.random()-5,10*Math.random()-5,10*Math.random()-5],r=dt(1,[e,n,i,1]),a=[ft(this.gl,r.position),ft(this.gl,r.color),ft(this.gl,r.normal)],s=vt(this.gl,r.indices);this.items[t]={geometry:r,VBO:a,IBO:s,position:o}}}renderItemsGeometry(t){for(let e=0;e<this.items.length;e++){mt(this.gl,this.items[e].VBO,this.attLocation,this.attStride),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.items[e].IBO);let n=G();Z(n,n,this.items[e].position),Q(n,n,t/1e3,[1,1,1]),this.setupMvp(n),this.gl.drawElements(this.gl.TRIANGLES,this.items[e].geometry.indices.length,this.gl.UNSIGNED_SHORT,0)}}setupAxisGeometry(){this.axis.geometry=ut(20),this.axis.VBO=[ft(this.gl,this.axis.geometry.position),ft(this.gl,this.axis.geometry.color)]}renderAxis(t){mt(this.gl,this.axis.VBO,this.attLocation,this.attStride);let e=G();Z(e,e,t),this.setupMvp(e),this.gl.drawArrays(this.gl.LINES,0,this.axis.geometry.position.length/3)}setupMvp(t){const e=G();X(e,t),Y(e,e),this.gl.uniformMatrix4fv(this.uniLocation.normalMatrix,!1,e);const n=G();W(n,this.vpMatrix,t),this.gl.uniformMatrix4fv(this.uniLocation.mvpMatrix,!1,n)}render(){this.taxis.begin(),this.taxis.ticker(((t,e)=>{this.setupRendering(),this.renderItemsGeometry(t),this.renderAxis([0,0,0])}))}reflectParameters(){this.parameters.cullFace?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.parameters.depthTest?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST)}}function Dt(e){let n,i,o,r;return{c(){n=u("canvas"),i=p(),o=u("div"),r=u("div"),c(n,"class","w-full h-full"),c(o,"class","fixed right-8 top-8")},m(t,a){l(t,n,a),e[2](n),l(t,i,a),l(t,o,a),s(o,r),e[3](r)},p:t,i:t,o:t,d(t){t&&h(n),e[2](null),t&&h(i),t&&h(o),e[3](null)}}}function Nt(t,e,n){let i,o;const r=new Tt;return g((()=>{r.init(i,o)})),b((()=>{r.destroy()})),[i,o,function(t){x[t?"unshift":"push"]((()=>{i=t,n(0,i)}))},function(t){x[t?"unshift":"push"]((()=>{o=t,n(1,o)}))}]}class $t extends z{constructor(t){super(),$(this,t,Nt,Dt,r,{})}}var zt="precision mediump float;\nuniform float ambient;\nuniform bool enableAmbientLight;\nvarying vec4 vColor;\n\nvoid main(){\n    float ambientIntensity = enableAmbientLight ? ambient : 0.0;\n    vec3 rgb = vColor.rgb * min(ambientIntensity, 1.0);\n    gl_FragColor = vec4(rgb, 1.0);\n}\n\n",jt="attribute vec3 position;\nattribute vec4 color;\nuniform mat4 mvpMatrix;\nvarying vec4 vColor;\n\n\nvoid main(){\n    vColor = color;\n\n    gl_Position = mvpMatrix * vec4(position, 1.0);\n}\n\n";const{attribute:Ht,uniform:Ut,uniLocation:Kt}=_t({vertex:jt,fragment:zt});class qt{constructor(){this.program=null,this.pMatrix=G(),this.vMatrix=G(),this.vpMatrix=G(),this.attLocation=[],this.attStride=[],this.uniLocation=Kt,this.parameters={cullFace:!0,depthTest:!0,ambientLight:{enable:!0,intensity:.5}},this.axis={geometry:null,VBO:[],IBO:[]},this.items=[],this.taxis=new U}init(t,e){this.canvas=t,this.gl=t.getContext("webgl"),this.camera=new gt(t,{position:{direction:[0,1,1],distance:15}}),Vt(this.parameters,e),this.addResizeEvent(),this.setupProgram(),this.setupItemsGeometry(),this.setupAxisGeometry(),this.setupLocation(),this.render()}destroy(){this.taxis.reset()}setupProgram(){const t=ct(this.gl,jt,this.gl.VERTEX_SHADER),e=ct(this.gl,zt,this.gl.FRAGMENT_SHADER);this.program=pt(this.gl,t,e),this.gl.useProgram(this.program)}addResizeEvent(){this.resizeCanvas(),window.addEventListener("resize",this.resizeCanvas,{passive:!0})}resizeCanvas(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}setupLocation(){Ht.forEach(((t,e)=>{this.attLocation[e]=this.gl.getAttribLocation(this.program,t.variable),this.attStride[e]=t.attStride})),Object.keys(this.uniLocation).forEach((t=>{this.uniLocation[t]=this.gl.getUniformLocation(this.program,t)}))}setupRendering(){this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.clearColor(.1,.12,.14,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.reflectParameters(),this.gl.uniform1f(this.uniLocation.ambient,this.parameters.ambientLight.intensity),this.gl.uniform1i(this.uniLocation.enableAmbientLight,Number(this.parameters.ambientLight.enable)),X(this.vMatrix,this.camera.update()),J(this.pMatrix,45,this.canvas.width/this.canvas.height,.1,20),W(this.vpMatrix,this.pMatrix,this.vMatrix)}setupItemsGeometry(){for(let t=0;t<20;t++){const e=Math.random(),n=Math.random(),i=Math.random(),o=[10*Math.random()-5,10*Math.random()-5,10*Math.random()-5],r=dt(1,[e,n,i,1]),a=[ft(this.gl,r.position),ft(this.gl,r.color),ft(this.gl,r.normal)],s=vt(this.gl,r.indices);this.items[t]={geometry:r,VBO:a,IBO:s,position:o}}}renderItemsGeometry(t){for(let e=0;e<this.items.length;e++){mt(this.gl,this.items[e].VBO,this.attLocation,this.attStride),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.items[e].IBO);let n=G();Z(n,n,this.items[e].position),Q(n,n,t/1e3,[1,1,1]),this.setupMvp(n),this.gl.drawElements(this.gl.TRIANGLES,this.items[e].geometry.indices.length,this.gl.UNSIGNED_SHORT,0)}}setupAxisGeometry(){this.axis.geometry=ut(20),this.axis.VBO=[ft(this.gl,this.axis.geometry.position),ft(this.gl,this.axis.geometry.color)]}renderAxis(t){mt(this.gl,this.axis.VBO,this.attLocation,this.attStride);let e=G();Z(e,e,t),this.setupMvp(e),this.gl.drawArrays(this.gl.LINES,0,this.axis.geometry.position.length/3)}setupMvp(t){const e=G();W(e,this.vpMatrix,t),this.gl.uniformMatrix4fv(this.uniLocation.mvpMatrix,!1,e)}render(){this.taxis.begin(),this.taxis.ticker(((t,e)=>{this.setupRendering(),this.renderItemsGeometry(t),this.renderAxis([0,0,0])}))}reflectParameters(){this.parameters.cullFace?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.parameters.depthTest?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST)}}function Gt(e){let n,i,o,r;return{c(){n=u("canvas"),i=p(),o=u("div"),r=u("div"),c(n,"class","w-full h-full"),c(o,"class","fixed right-8 top-8")},m(t,a){l(t,n,a),e[2](n),l(t,i,a),l(t,o,a),s(o,r),e[3](r)},p:t,i:t,o:t,d(t){t&&h(n),e[2](null),t&&h(i),t&&h(o),e[3](null)}}}function Yt(t,e,n){let i,o;const r=new qt;return g((()=>{r.init(i,o)})),b((()=>{r.destroy()})),[i,o,function(t){x[t?"unshift":"push"]((()=>{i=t,n(0,i)}))},function(t){x[t?"unshift":"push"]((()=>{o=t,n(1,o)}))}]}class Xt extends z{constructor(t){super(),$(this,t,Yt,Gt,r,{})}}var Wt="precision mediump float;\nvarying vec4 vColor;\n\nvoid main(){\n    gl_FragColor = vColor;\n}\n\n",Zt="attribute vec3 position;\nattribute vec4 color;\nattribute vec3 normal;\nuniform mat4 mvpMatrix;\nuniform mat4 normalMatrix;\nvarying vec3 vPosition;\nvarying vec4 vColor;\nvarying vec3 vNormal;\n\n\nvoid main(){\n    vPosition = position;\n    vColor = color;\n    vNormal = (normalMatrix * vec4(normal, 0.0)).xyz;\n\n    gl_Position = mvpMatrix * vec4(position, 1.0);\n}\n\n";const{attribute:Qt,uniform:Jt,uniLocation:te}=_t({vertex:Zt,fragment:Wt}),ee=20;class ne{constructor(){this.program=null,this.pMatrix=G(),this.vMatrix=G(),this.vpMatrix=G(),this.attLocation=[],this.attStride=[],this.uniLocation=te,this.parameters={cullFace:!1,depthTest:!0,light:{position:{x:30,y:30,z:30}}},this.floor={geometry:null,VBO:[],IBO:[]},this.items=[],this.itemsPosition=[],this.taxis=new U}init(t,e){this.canvas=t,this.gl=t.getContext("webgl"),this.camera=new gt(t,{isMovable:!1,position:{direction:[0,1,1],distance:20},maxDistance:50}),Vt(this.parameters,e),this.addResizeEvent(),this.setupProgram(),this.setupItemsGeometry(),this.setupAxisGeometry(),this.setupLocation(),this.render()}destroy(){this.taxis.reset()}setupProgram(){const t=ct(this.gl,Zt,this.gl.VERTEX_SHADER),e=ct(this.gl,Wt,this.gl.FRAGMENT_SHADER);this.program=pt(this.gl,t,e),this.gl.useProgram(this.program)}addResizeEvent(){this.resizeCanvas(),window.addEventListener("resize",this.resizeCanvas,{passive:!0})}resizeCanvas(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}setupLocation(){Qt.forEach(((t,e)=>{this.attLocation[e]=this.gl.getAttribLocation(this.program,t.variable),this.attStride[e]=t.attStride})),Object.keys(this.uniLocation).forEach((t=>{this.uniLocation[t]=this.gl.getUniformLocation(this.program,t)}))}setupRendering(t){this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.clearColor(.1,.12,.14,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.reflectParameters(),X(this.vMatrix,this.camera.update()),J(this.pMatrix,45,this.canvas.width/this.canvas.height,.1,40),W(this.vpMatrix,this.pMatrix,this.vMatrix)}setupItemsGeometry(){for(let t=0;t<40;t++){const e=(Math.random()-.5)*ee,n=(Math.random()-.5)*ee,i=(Math.random()-.5)*ee;this.itemsPosition[t]=[e,0,i],this.items[t]={geometry:null,VBO:[],IBO:[]},this.items[t].geometry=dt(1,[e/ee,n/ee,i/ee,1]),this.items[t].VBO=[ft(this.gl,this.items[t].geometry.position),ft(this.gl,this.items[t].geometry.color),ft(this.gl,this.items[t].geometry.normal)],this.items[t].IBO=vt(this.gl,this.items[t].geometry.indices)}}renderItemsGeometry(){this.items.forEach(((t,e)=>{mt(this.gl,this.items[e].VBO,this.attLocation,this.attStride),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.items[e].IBO);let n=G();Z(n,n,this.itemsPosition[e]),Z(n,n,[0,.5,0]),this.setupMvp(n),this.gl.drawElements(this.gl.TRIANGLES,this.items[e].geometry.indices.length,this.gl.UNSIGNED_SHORT,0)}))}setupAxisGeometry(){this.floor.geometry=((t,e,n)=>{const i=t/2,o=e/2;return{position:new Float32Array([-i,0,o,i,0,o,-i,0,-o,i,0,-o]),normal:new Float32Array([0,1,0,0,1,0,0,1,0,0,1,0]),color:new Float32Array([n[0],n[1],n[2],n[3],n[0],n[1],n[2],n[3],n[0],n[1],n[2],n[3],n[0],n[1],n[2],n[3]]),indices:[0,1,2,2,1,3]}})(20,20,[.45,.45,.45,1]),this.floor.VBO=[ft(this.gl,this.floor.geometry.position),ft(this.gl,this.floor.geometry.color)],this.floor.IBO=vt(this.gl,this.floor.geometry.indices)}renderAxis(t){mt(this.gl,this.floor.VBO,this.attLocation,this.attStride);let e=G();Z(e,e,t),this.setupMvp(e),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.floor.IBO),this.gl.drawElements(this.gl.TRIANGLES,this.floor.geometry.indices.length,this.gl.UNSIGNED_SHORT,0)}setupMvp(t){const e=G();X(e,t),Y(e,e),this.gl.uniformMatrix4fv(this.uniLocation.normalMatrix,!1,e);const n=G();W(n,this.vpMatrix,t),this.gl.uniformMatrix4fv(this.uniLocation.mvpMatrix,!1,n)}render(){this.taxis.begin(),this.taxis.ticker(((t,e)=>{this.setupRendering(t),this.renderItemsGeometry(),this.renderAxis([0,0,0])}))}reflectParameters(){this.parameters.cullFace?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.parameters.depthTest?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST)}}function ie(e){let n,i,o,r;return{c(){n=u("canvas"),i=p(),o=u("div"),r=u("div"),c(n,"class","w-full h-full"),c(o,"class","fixed right-8 top-8")},m(t,a){l(t,n,a),e[2](n),l(t,i,a),l(t,o,a),s(o,r),e[3](r)},p:t,i:t,o:t,d(t){t&&h(n),e[2](null),t&&h(i),t&&h(o),e[3](null)}}}function oe(t,e,n){let i,o;const r=new ne;return g((()=>{r.init(i,o)})),b((()=>{r.destroy()})),[i,o,function(t){x[t?"unshift":"push"]((()=>{i=t,n(0,i)}))},function(t){x[t?"unshift":"push"]((()=>{o=t,n(1,o)}))}]}class re extends z{constructor(t){super(),$(this,t,oe,ie,r,{})}}const ae=[];function se(e,n=t){let i;const o=new Set;function a(t){if(r(e,t)&&(e=t,i)){const t=!ae.length;for(const t of o)t[1](),ae.push(t,e);if(t){for(let t=0;t<ae.length;t+=2)ae[t][0](ae[t+1]);ae.length=0}}}return{set:a,update:function(t){a(t(e))},subscribe:function(r,s=t){const l=[r,s];return o.add(l),1===o.size&&(i=n(a)||t),r(e),()=>{o.delete(l),0===o.size&&(i(),i=null)}}}}const le=se(window.location.href),he=window.URL,ue=history.pushState,de=history.replaceState,pe=()=>le.set(window.location.href);history.pushState=function(){ue.apply(this,arguments),pe()},history.replaceState=function(){de.apply(this,arguments),pe()},window.addEventListener("popstate",pe),window.addEventListener("hashchange",pe);var ce={subscribe:function(e,n,r){const s=!Array.isArray(e),l=s?[e]:e,h=n.length<2;return{subscribe:se(r,(e=>{let r=!1;const u=[];let d=0,p=t;const c=()=>{if(d)return;p();const i=n(s?u[0]:u,e);h?e(i):p=o(i)?i:t},f=l.map(((t,e)=>a(t,(t=>{u[e]=t,d&=~(1<<e),r&&c()}),(()=>{d|=1<<e}))));return r=!0,c(),function(){i(f),p()}})).subscribe}}(le,(t=>new he(t))).subscribe,ssrSet:t=>le.set(t)};function fe(t,e,n){const i=t.slice();return i[3]=e[n],i[5]=n,i}function ve(t){let e,n,i,o=t[2],r=[];for(let e=0;e<o.length;e+=1)r[e]=me(fe(t,o,e));return{c(){e=u("div"),n=u("div"),i=u("div");for(let t=0;t<r.length;t+=1)r[t].c();c(i,"class","grid grid-cols-1 gap-4 sm:grid-cols-2"),c(n,"class","max-w-3xl mx-auto"),c(e,"class","max-w-7xl mx-auto p-8")},m(t,o){l(t,e,o),s(e,n),s(n,i);for(let t=0;t<r.length;t+=1)r[t].m(i,null)},p(t,e){if(4&e){let n;for(o=t[2],n=0;n<o.length;n+=1){const a=fe(t,o,n);r[n]?r[n].p(a,e):(r[n]=me(a),r[n].c(),r[n].m(i,null))}for(;n<r.length;n+=1)r[n].d(1);r.length=o.length}},d(t){t&&h(e),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(r,t)}}}function me(e){let n,i,o,r,a,f,v,m,g,b,_=e[3].hash+"",x=e[3].description&&function(e){let n,i,o=e[3].description+"";return{c(){n=u("p"),i=d(o),c(n,"class","text-sm text-gray-500 truncate")},m(t,e){l(t,n,e),s(n,i)},p:t,d(t){t&&h(n)}}}(e);return{c(){n=u("div"),i=u("div"),o=u("a"),r=u("span"),a=p(),f=u("span"),v=d(_),m=p(),x&&x.c(),b=p(),c(r,"class","absolute inset-0"),c(r,"aria-hidden","true"),c(f,"class","text-sm font-medium text-gray-900"),c(o,"href",g=e[3].hash),c(o,"class","focus:outline-none"),c(i,"class","flex-1 min-w-0"),c(n,"class","relative rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm flex items-center space-x-3 hover:border-gray-400 focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500")},m(t,e){l(t,n,e),s(n,i),s(i,o),s(o,r),s(o,a),s(o,f),s(f,v),s(o,m),x&&x.m(o,null),s(n,b)},p(t,e){t[3].description&&x.p(t,e)},d(t){t&&h(n),x&&x.d()}}}function ge(t){let e,n,i;var o=t[1][t[0].hash.replace("#","")].component;return o&&(e=new o({})),{c(){e&&O(e.$$.fragment),n=d("")},m(t,o){e&&T(e,t,o),l(t,n,o),i=!0},p(t,i){if(o!==(o=t[1][t[0].hash.replace("#","")].component)){if(e){S();const t=e;B(t.$$.fragment,1,0,(()=>{D(t,1)})),F()}o?(e=new o({}),O(e.$$.fragment),R(e.$$.fragment,1),T(e,n.parentNode,n)):e=null}},i(t){i||(e&&R(e.$$.fragment,t),i=!0)},o(t){e&&B(e.$$.fragment,t),i=!1},d(t){t&&h(n),e&&D(e,t)}}}function be(t){let e,n,i,o=!t[0].hash&&ve(t),r=!!t[0].hash&&ge(t);return{c(){e=u("main"),o&&o.c(),n=p(),r&&r.c(),c(e,"class","w-full h-full")},m(t,a){l(t,e,a),o&&o.m(e,null),s(e,n),r&&r.m(e,null),i=!0},p(t,[i]){t[0].hash?o&&(o.d(1),o=null):o?o.p(t,i):(o=ve(t),o.c(),o.m(e,n)),t[0].hash?r?(r.p(t,i),1&i&&R(r,1)):(r=ge(t),r.c(),R(r,1),r.m(e,null)):r&&(S(),B(r,1,1,(()=>{r=null})),F())},i(t){i||(R(r),i=!0)},o(t){B(r),i=!1},d(t){t&&h(e),o&&o.d(),r&&r.d()}}}function _e(t,e,n){let i;var o,r;o=ce,r=t=>n(0,i=t),t.$$.on_destroy.push(a(o,r));const s={camera:{hash:"#camera",component:It,description:"OrbitControls"},light:{hash:"#light",component:$t,description:"Phong reflection model"},lightAmbient:{hash:"#lightAmbient",component:Xt,description:"Ambient"},picking:{hash:"#picking",component:re,description:"..."}},l=Object.values(s);return[i,s,l]}return new class extends z{constructor(t){super(),$(this,t,_e,be,r,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
